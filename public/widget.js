(function(){"use strict";var oe,E,Ie,A,Pe,Oe,Ae,Ne,he,_e,xe,W={},Fe=[],Zt=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,re=Array.isArray;function P(e,t){for(var n in t)e[n]=t[n];return e}function me(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function s(e,t,n){var o,i,r,l={};for(r in t)r=="key"?o=t[r]:r=="ref"?i=t[r]:l[r]=t[r];if(arguments.length>2&&(l.children=arguments.length>3?oe.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(r in e.defaultProps)l[r]===void 0&&(l[r]=e.defaultProps[r]);return se(e,l,o,i,null)}function se(e,t,n,o,i){var r={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:i??++Ie,__i:-1,__u:0};return i==null&&E.vnode!=null&&E.vnode(r),r}function ie(e){return e.children}function le(e,t){this.props=e,this.context=t}function N(e,t){if(t==null)return e.__?N(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?N(e):null}function We(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return We(e)}}function je(e){(!e.__d&&(e.__d=!0)&&A.push(e)&&!ae.__r++||Pe!=E.debounceRendering)&&((Pe=E.debounceRendering)||Oe)(ae)}function ae(){for(var e,t,n,o,i,r,l,c=1;A.length;)A.length>c&&A.sort(Ae),e=A.shift(),c=A.length,e.__d&&(n=void 0,o=void 0,i=(o=(t=e).__v).__e,r=[],l=[],t.__P&&((n=P({},o)).__v=o.__v+1,E.vnode&&E.vnode(n),ye(t.__P,n,o,t.__n,t.__P.namespaceURI,32&o.__u?[i]:null,r,i??N(o),!!(32&o.__u),l),n.__v=o.__v,n.__.__k[n.__i]=n,Ye(r,n,l),o.__e=o.__=null,n.__e!=i&&We(n)));ae.__r=0}function Ue(e,t,n,o,i,r,l,c,g,d,f){var a,u,h,S,C,w,x,m=o&&o.__k||Fe,B=t.length;for(g=Qt(n,t,m,g,B),a=0;a<B;a++)(h=n.__k[a])!=null&&(u=h.__i==-1?W:m[h.__i]||W,h.__i=a,w=ye(e,h,u,i,r,l,c,g,d,f),S=h.__e,h.ref&&u.ref!=h.ref&&(u.ref&&Se(u.ref,null,h),f.push(h.ref,h.__c||S,h)),C==null&&S!=null&&(C=S),(x=!!(4&h.__u))||u.__k===h.__k?g=qe(h,g,e,x):typeof h.type=="function"&&w!==void 0?g=w:S&&(g=S.nextSibling),h.__u&=-7);return n.__e=C,g}function Qt(e,t,n,o,i){var r,l,c,g,d,f=n.length,a=f,u=0;for(e.__k=new Array(i),r=0;r<i;r++)(l=t[r])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=e.__k[r]=se(null,l,null,null,null):re(l)?l=e.__k[r]=se(ie,{children:l},null,null,null):l.constructor===void 0&&l.__b>0?l=e.__k[r]=se(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):e.__k[r]=l,g=r+u,l.__=e,l.__b=e.__b+1,c=null,(d=l.__i=en(l,n,g,a))!=-1&&(a--,(c=n[d])&&(c.__u|=2)),c==null||c.__v==null?(d==-1&&(i>f?u--:i<f&&u++),typeof l.type!="function"&&(l.__u|=4)):d!=g&&(d==g-1?u--:d==g+1?u++:(d>g?u--:u++,l.__u|=4))):e.__k[r]=null;if(a)for(r=0;r<f;r++)(c=n[r])!=null&&(2&c.__u)==0&&(c.__e==o&&(o=N(c)),Je(c,c));return o}function qe(e,t,n,o){var i,r;if(typeof e.type=="function"){for(i=e.__k,r=0;i&&r<i.length;r++)i[r]&&(i[r].__=e,t=qe(i[r],t,n,o));return t}e.__e!=t&&(o&&(t&&e.type&&!t.parentNode&&(t=N(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function en(e,t,n,o){var i,r,l,c=e.key,g=e.type,d=t[n],f=d!=null&&(2&d.__u)==0;if(d===null&&c==null||f&&c==d.key&&g==d.type)return n;if(o>(f?1:0)){for(i=n-1,r=n+1;i>=0||r<t.length;)if((d=t[l=i>=0?i--:r++])!=null&&(2&d.__u)==0&&c==d.key&&g==d.type)return l}return-1}function Xe(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||Zt.test(t)?n:n+"px"}function ce(e,t,n,o,i){var r,l;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||Xe(e.style,t,"");if(n)for(t in n)o&&n[t]==o[t]||Xe(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")r=t!=(t=t.replace(Ne,"$1")),l=t.toLowerCase(),t=l in e||t=="onFocusOut"||t=="onFocusIn"?l.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?o?n.u=o.u:(n.u=he,e.addEventListener(t,r?xe:_e,r)):e.removeEventListener(t,r?xe:_e,r);else{if(i=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function Ve(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=he++;else if(t.t<n.u)return;return n(E.event?E.event(t):t)}}}function ye(e,t,n,o,i,r,l,c,g,d){var f,a,u,h,S,C,w,x,m,B,y,T,H,I,D,L,_,v=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(g=!!(32&n.__u),r=[c=t.__e=n.__e]),(f=E.__b)&&f(t);e:if(typeof v=="function")try{if(x=t.props,m="prototype"in v&&v.prototype.render,B=(f=v.contextType)&&o[f.__c],y=f?B?B.props.value:f.__:o,n.__c?w=(a=t.__c=n.__c).__=a.__E:(m?t.__c=a=new v(x,y):(t.__c=a=new le(x,y),a.constructor=v,a.render=nn),B&&B.sub(a),a.state||(a.state={}),a.__n=o,u=a.__d=!0,a.__h=[],a._sb=[]),m&&a.__s==null&&(a.__s=a.state),m&&v.getDerivedStateFromProps!=null&&(a.__s==a.state&&(a.__s=P({},a.__s)),P(a.__s,v.getDerivedStateFromProps(x,a.__s))),h=a.props,S=a.state,a.__v=t,u)m&&v.getDerivedStateFromProps==null&&a.componentWillMount!=null&&a.componentWillMount(),m&&a.componentDidMount!=null&&a.__h.push(a.componentDidMount);else{if(m&&v.getDerivedStateFromProps==null&&x!==h&&a.componentWillReceiveProps!=null&&a.componentWillReceiveProps(x,y),t.__v==n.__v||!a.__e&&a.shouldComponentUpdate!=null&&a.shouldComponentUpdate(x,a.__s,y)===!1){for(t.__v!=n.__v&&(a.props=x,a.state=a.__s,a.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function($){$&&($.__=t)}),T=0;T<a._sb.length;T++)a.__h.push(a._sb[T]);a._sb=[],a.__h.length&&l.push(a);break e}a.componentWillUpdate!=null&&a.componentWillUpdate(x,a.__s,y),m&&a.componentDidUpdate!=null&&a.__h.push(function(){a.componentDidUpdate(h,S,C)})}if(a.context=y,a.props=x,a.__P=e,a.__e=!1,H=E.__r,I=0,m){for(a.state=a.__s,a.__d=!1,H&&H(t),f=a.render(a.props,a.state,a.context),D=0;D<a._sb.length;D++)a.__h.push(a._sb[D]);a._sb=[]}else do a.__d=!1,H&&H(t),f=a.render(a.props,a.state,a.context),a.state=a.__s;while(a.__d&&++I<25);a.state=a.__s,a.getChildContext!=null&&(o=P(P({},o),a.getChildContext())),m&&!u&&a.getSnapshotBeforeUpdate!=null&&(C=a.getSnapshotBeforeUpdate(h,S)),L=f,f!=null&&f.type===ie&&f.key==null&&(L=Ge(f.props.children)),c=Ue(e,re(L)?L:[L],t,n,o,i,r,l,c,g,d),a.base=t.__e,t.__u&=-161,a.__h.length&&l.push(a),w&&(a.__E=a.__=null)}catch($){if(t.__v=null,g||r!=null)if($.then){for(t.__u|=g?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;r[r.indexOf(c)]=null,t.__e=c}else{for(_=r.length;_--;)me(r[_]);be(t)}else t.__e=n.__e,t.__k=n.__k,$.then||be(t);E.__e($,t,n)}else r==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):c=t.__e=tn(n.__e,t,n,o,i,r,l,g,d);return(f=E.diffed)&&f(t),128&t.__u?void 0:c}function be(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(be)}function Ye(e,t,n){for(var o=0;o<n.length;o++)Se(n[o],n[++o],n[++o]);E.__c&&E.__c(t,e),e.some(function(i){try{e=i.__h,i.__h=[],e.some(function(r){r.call(i)})}catch(r){E.__e(r,i.__v)}})}function Ge(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:re(e)?e.map(Ge):P({},e)}function tn(e,t,n,o,i,r,l,c,g){var d,f,a,u,h,S,C,w=n.props||W,x=t.props,m=t.type;if(m=="svg"?i="http://www.w3.org/2000/svg":m=="math"?i="http://www.w3.org/1998/Math/MathML":i||(i="http://www.w3.org/1999/xhtml"),r!=null){for(d=0;d<r.length;d++)if((h=r[d])&&"setAttribute"in h==!!m&&(m?h.localName==m:h.nodeType==3)){e=h,r[d]=null;break}}if(e==null){if(m==null)return document.createTextNode(x);e=document.createElementNS(i,m,x.is&&x),c&&(E.__m&&E.__m(t,r),c=!1),r=null}if(m==null)w===x||c&&e.data==x||(e.data=x);else{if(r=r&&oe.call(e.childNodes),!c&&r!=null)for(w={},d=0;d<e.attributes.length;d++)w[(h=e.attributes[d]).name]=h.value;for(d in w)if(h=w[d],d!="children"){if(d=="dangerouslySetInnerHTML")a=h;else if(!(d in x)){if(d=="value"&&"defaultValue"in x||d=="checked"&&"defaultChecked"in x)continue;ce(e,d,null,h,i)}}for(d in x)h=x[d],d=="children"?u=h:d=="dangerouslySetInnerHTML"?f=h:d=="value"?S=h:d=="checked"?C=h:c&&typeof h!="function"||w[d]===h||ce(e,d,h,w[d],i);if(f)c||a&&(f.__html==a.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(a&&(e.innerHTML=""),Ue(t.type=="template"?e.content:e,re(u)?u:[u],t,n,o,m=="foreignObject"?"http://www.w3.org/1999/xhtml":i,r,l,r?r[0]:n.__k&&N(n,0),c,g),r!=null)for(d=r.length;d--;)me(r[d]);c||(d="value",m=="progress"&&S==null?e.removeAttribute("value"):S!=null&&(S!==e[d]||m=="progress"&&!S||m=="option"&&S!=w[d])&&ce(e,d,S,w[d],i),d="checked",C!=null&&C!=e[d]&&ce(e,d,C,w[d],i))}return e}function Se(e,t,n){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&t==null||(e.__u=e(t))}else e.current=t}catch(i){E.__e(i,n)}}function Je(e,t,n){var o,i;if(E.unmount&&E.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||Se(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(r){E.__e(r,t)}o.base=o.__P=null}if(o=e.__k)for(i=0;i<o.length;i++)o[i]&&Je(o[i],t,n||typeof e.type!="function");n||me(e.__e),e.__c=e.__=e.__e=void 0}function nn(e,t,n){return this.constructor(e,n)}function on(e,t,n){var o,i,r,l;t==document&&(t=document.documentElement),E.__&&E.__(e,t),i=(o=!1)?null:t.__k,r=[],l=[],ye(t,e=t.__k=s(ie,null,[e]),i||W,W,t.namespaceURI,i?null:t.firstChild?oe.call(t.childNodes):null,r,i?i.__e:t.firstChild,o,l),Ye(r,e,l)}oe=Fe.slice,E={__e:function(e,t,n,o){for(var i,r,l;t=t.__;)if((i=t.__c)&&!i.__)try{if((r=i.constructor)&&r.getDerivedStateFromError!=null&&(i.setState(r.getDerivedStateFromError(e)),l=i.__d),i.componentDidCatch!=null&&(i.componentDidCatch(e,o||{}),l=i.__d),l)return i.__E=i}catch(c){e=c}throw e}},Ie=0,le.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=P({},this.state),typeof e=="function"&&(e=e(P({},n),this.props)),e&&P(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),je(this))},le.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),je(this))},le.prototype.render=ie,A=[],Oe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Ae=function(e,t){return e.__v.__b-t.__v.__b},ae.__r=0,Ne=/(PointerCapture)$|Capture$/i,he=0,_e=Ve(!1),xe=Ve(!0);var j,R,ve,Ke,U=0,Ze=[],M=E,Qe=M.__b,et=M.__r,tt=M.diffed,nt=M.__c,ot=M.unmount,rt=M.__;function we(e,t){M.__h&&M.__h(R,e,U||t),U=0;var n=R.__H||(R.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function b(e){return U=1,rn(at,e)}function rn(e,t,n){var o=we(j++,2);if(o.t=e,!o.__c&&(o.__=[at(void 0,t),function(c){var g=o.__N?o.__N[0]:o.__[0],d=o.t(g,c);g!==d&&(o.__N=[d,o.__[1]],o.__c.setState({}))}],o.__c=R,!R.__f)){var i=function(c,g,d){if(!o.__c.__H)return!0;var f=o.__c.__H.__.filter(function(u){return!!u.__c});if(f.every(function(u){return!u.__N}))return!r||r.call(this,c,g,d);var a=o.__c.props!==c;return f.forEach(function(u){if(u.__N){var h=u.__[0];u.__=u.__N,u.__N=void 0,h!==u.__[0]&&(a=!0)}}),r&&r.call(this,c,g,d)||a};R.__f=!0;var r=R.shouldComponentUpdate,l=R.componentWillUpdate;R.componentWillUpdate=function(c,g,d){if(this.__e){var f=r;r=void 0,i(c,g,d),r=f}l&&l.call(this,c,g,d)},R.shouldComponentUpdate=i}return o.__N||o.__}function O(e,t){var n=we(j++,3);!M.__s&&lt(n.__H,t)&&(n.__=e,n.u=t,R.__H.__h.push(n))}function F(e){return U=5,st(function(){return{current:e}},[])}function st(e,t){var n=we(j++,7);return lt(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function k(e,t){return U=8,st(function(){return e},t)}function sn(){for(var e;e=Ze.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(de),e.__H.__h.forEach(ke),e.__H.__h=[]}catch(t){e.__H.__h=[],M.__e(t,e.__v)}}M.__b=function(e){R=null,Qe&&Qe(e)},M.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),rt&&rt(e,t)},M.__r=function(e){et&&et(e),j=0;var t=(R=e.__c).__H;t&&(ve===R?(t.__h=[],R.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(de),t.__h.forEach(ke),t.__h=[],j=0)),ve=R},M.diffed=function(e){tt&&tt(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(Ze.push(t)!==1&&Ke===M.requestAnimationFrame||((Ke=M.requestAnimationFrame)||ln)(sn)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),ve=R=null},M.__c=function(e,t){t.some(function(n){try{n.__h.forEach(de),n.__h=n.__h.filter(function(o){return!o.__||ke(o)})}catch(o){t.some(function(i){i.__h&&(i.__h=[])}),t=[],M.__e(o,n.__v)}}),nt&&nt(e,t)},M.unmount=function(e){ot&&ot(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{de(o)}catch(i){t=i}}),n.__H=void 0,t&&M.__e(t,n.__v))};var it=typeof requestAnimationFrame=="function";function ln(e){var t,n=function(){clearTimeout(o),it&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,35);it&&(t=requestAnimationFrame(n))}function de(e){var t=R,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),R=t}function ke(e){var t=R;e.__c=e.__(),R=t}function lt(e,t){return!e||e.length!==t.length||t.some(function(n,o){return n!==e[o]})}function at(e,t){return typeof t=="function"?t(e):t}const p={fabBg:"#3b82f6",fabBgHover:"#2563eb",panelBg:"#0f172a",panelBorder:"#1e293b",panelHeaderBg:"#1e293b",toolBtnBg:"#1e293b",toolBtnBgHover:"#334155",toolBtnBgActive:"#3b82f6",text:"#e2e8f0",textMuted:"#94a3b8",textBright:"#f8fafc",closeBtnHover:"#ef4444",shadow:"rgba(0, 0, 0, 0.4)"},ct=48,dt=300,an=5,cn={position:"fixed",width:`${ct}px`,height:`${ct}px`,borderRadius:"50%",backgroundColor:p.fabBg,color:"#fff",border:"none",cursor:"grab",fontSize:"20px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999,boxShadow:`0 4px 12px ${p.shadow}`,transition:"background-color 0.15s ease, box-shadow 0.15s ease",touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},dn={position:"fixed",top:"0",right:"0",width:`${dt}px`,height:"100vh",backgroundColor:p.panelBg,borderLeft:`1px solid ${p.panelBorder}`,zIndex:999998,display:"flex",flexDirection:"column",fontFamily:"system-ui, -apple-system, sans-serif",color:p.text,boxShadow:`-4px 0 20px ${p.shadow}`},un={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",backgroundColor:p.panelHeaderBg,borderBottom:`1px solid ${p.panelBorder}`,flexShrink:"0"},pn={fontSize:"14px",fontWeight:"600",color:p.textBright,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"220px"},fn={width:"28px",height:"28px",borderRadius:"6px",border:"none",backgroundColor:"transparent",color:p.textMuted,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",lineHeight:"1",flexShrink:"0"},gn={display:"flex",flexDirection:"column",gap:"4px",padding:"12px",overflowY:"auto",flex:"1"},hn={display:"flex",alignItems:"center",gap:"10px",padding:"10px 12px",borderRadius:"8px",border:"none",backgroundColor:p.toolBtnBg,color:p.text,cursor:"pointer",fontSize:"13px",fontWeight:"500",textAlign:"left",transition:"background-color 0.12s ease",width:"100%"},_n={width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",flexShrink:"0"},xn={flex:"1",padding:"16px",overflowY:"auto",fontSize:"13px",color:p.textMuted,display:"flex",alignItems:"center",justifyContent:"center"},mn="translateX(0)",yn=`translateX(${dt}px)`,bn=500;let Sn=1;const q=[],X=[];function vn(){const e=new WeakSet;return(t,n)=>{if(typeof n=="object"&&n!==null){if(e.has(n))return"[Circular]";e.add(n)}return n}}function wn(e){if(e===null)return"null";if(e===void 0)return"undefined";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);if(e instanceof Error)return`${e.name}: ${e.message}`;try{return JSON.stringify(e,vn(),2)}catch{return String(e)}}function kn(e,t){const n={id:Sn++,level:e,args:t.map(wn),timestamp:Date.now()};q.length>=bn&&q.shift(),q.push(n);for(const o of X)o()}function V(){return[...q]}function Cn(){q.length=0;for(const e of X)e()}function ut(e){return X.push(e),()=>{const t=X.indexOf(e);t!==-1&&X.splice(t,1)}}function $n(){const e=["log","warn","error","info"];for(const t of e){const n=console[t].bind(console);console[t]=(...o)=>{kn(t,o),n(...o)}}}const pt={log:"#94a3b8",info:"#3b82f6",warn:"#eab308",error:"#ef4444"},En={log:"rgba(148, 163, 184, 0.15)",info:"rgba(59, 130, 246, 0.15)",warn:"rgba(234, 179, 8, 0.15)",error:"rgba(239, 68, 68, 0.15)"},ft=["log","info","warn","error"];function Bn(e){const t=new Date(e),n=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),i=String(t.getSeconds()).padStart(2,"0"),r=String(t.getMilliseconds()).padStart(3,"0");return`${n}:${o}:${i}.${r}`}const Tn={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden"},Rn={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",gap:"6px",flexShrink:"0"},Mn={display:"flex",gap:"4px",flexWrap:"wrap"},zn={padding:"3px 8px",borderRadius:"4px",border:"none",backgroundColor:p.toolBtnBg,color:p.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",flexShrink:"0"},Hn={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"0 4px 4px"},Ln={display:"flex",flexDirection:"column",gap:"2px",padding:"4px 6px",borderRadius:"4px",marginBottom:"2px",fontSize:"11px",fontFamily:"monospace",wordBreak:"break-all"},Dn={display:"flex",alignItems:"center",gap:"6px"},In={padding:"1px 5px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px",flexShrink:"0"},Pn={fontSize:"10px",color:p.textMuted,flexShrink:"0"},On={color:p.text,whiteSpace:"pre-wrap",lineHeight:"1.4"},An={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:p.textMuted,fontSize:"12px"};function Nn(e,t){return{padding:"2px 6px",borderRadius:"3px",border:"none",backgroundColor:e?pt[t]:p.toolBtnBg,color:e?"#fff":p.textMuted,cursor:"pointer",fontSize:"10px",fontWeight:"600",textTransform:"uppercase"}}function Fn(){const[e,t]=b(V),[n,o]=b(new Set(ft));O(()=>ut(()=>{t(V())}),[]);const i=k(()=>{Cn(),t([])},[]),r=k(c=>{o(g=>{const d=new Set(g);return d.has(c)?d.delete(c):d.add(c),d})},[]),l=e.filter(c=>n.has(c.level));return s("div",{style:Tn},s("div",{style:Rn},s("div",{style:Mn},ft.map(c=>s("button",{key:c,style:Nn(n.has(c),c),onClick:()=>r(c),title:`Toggle ${c} entries`},c))),s("button",{style:zn,onClick:i,title:"Clear console entries"},"Clear")),l.length===0?s("div",{style:An},"No console entries"):s("div",{style:Hn},l.map(c=>s("div",{key:c.id,style:{...Ln,backgroundColor:En[c.level]}},s("div",{style:Dn},s("span",{style:{...In,backgroundColor:pt[c.level],color:"#fff"}},c.level),s("span",{style:Pn},Bn(c.timestamp))),s("div",{style:On},c.args.join(" "))))))}const Wn=200;let Ce=1;const Y=[],G=[];function jn(e){if(!e.response)return 0;if(typeof e.response=="string")return e.response.length;if(e.response instanceof Blob)return e.response.size;if(e.response instanceof ArrayBuffer)return e.response.byteLength;try{return JSON.stringify(e.response).length}catch{return 0}}function gt(e){if(e==null)return 0;if(typeof e=="string")return e.length;if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength;if(e instanceof FormData){let t=0;return e.forEach(n=>{typeof n=="string"?t+=n.length:n instanceof Blob&&(t+=n.size)}),t}return e instanceof URLSearchParams?e.toString().length:0}function ht(e){const t={};return e.forEach((n,o)=>{t[o]=n}),t}function $e(e){Y.length>=Wn&&Y.shift(),Y.push(e);for(const t of G)t()}function J(){return[...Y]}function Un(){Y.length=0;for(const e of G)e()}function _t(e){return G.push(e),()=>{const t=G.indexOf(e);t!==-1&&G.splice(t,1)}}function qn(){const e=XMLHttpRequest.prototype,t=e.open,n=e.setRequestHeader,o=e.send,i=new WeakMap;e.open=function(r,l,...c){return i.set(this,{method:r.toUpperCase(),url:typeof l=="string"?l:String(l),requestHeaders:{},requestSize:0,startTime:0,timestamp:0}),t.call(this,r,l,...c)},e.setRequestHeader=function(r,l){const c=i.get(this);return c&&(c.requestHeaders[r]=l),n.call(this,r,l)},e.send=function(r){const l=i.get(this);return l&&(l.requestSize=gt(r??null),l.startTime=performance.now(),l.timestamp=Date.now(),this.addEventListener("loadend",()=>{const c=performance.now()-l.startTime,g={},d=this.getAllResponseHeaders();for(const a of d.trim().split(`\r
`)){const u=a.indexOf(": ");u!==-1&&(g[a.slice(0,u).toLowerCase()]=a.slice(u+2))}const f={id:Ce++,method:l.method,url:l.url,status:this.status,statusText:this.statusText||(this.status===0?"Network Error":""),duration:Math.round(c),requestSize:l.requestSize,responseSize:jn(this),requestHeaders:l.requestHeaders,responseHeaders:g,startTime:l.startTime,timestamp:l.timestamp};$e(f),i.delete(this)})),o.call(this,r)}}function Xn(){const e=window.fetch.bind(window);window.fetch=async(t,n)=>{const o=(n?.method??"GET").toUpperCase(),i=typeof t=="string"?t:t instanceof URL?t.href:t.url,r=gt(n?.body??null);let l={};if(n?.headers)if(n.headers instanceof Headers)l=ht(n.headers);else if(Array.isArray(n.headers))for(const[d,f]of n.headers)l[d]=f;else l={...n.headers};const c=performance.now(),g=Date.now();try{const d=await e(t,n),f=performance.now()-c,a=d.clone();let u=0;try{u=(await a.blob()).size}catch{u=0}const h={id:Ce++,method:o,url:i,status:d.status,statusText:d.statusText,duration:Math.round(f),requestSize:r,responseSize:u,requestHeaders:l,responseHeaders:ht(d.headers),startTime:c,timestamp:g};return $e(h),d}catch(d){const f=performance.now()-c,a={id:Ce++,method:o,url:i,status:0,statusText:"Network Error",duration:Math.round(f),requestSize:r,responseSize:0,requestHeaders:l,responseHeaders:{},startTime:c,timestamp:g};throw $e(a),d}},qn()}const Vn={GET:"#22c55e",POST:"#3b82f6",PUT:"#eab308",DELETE:"#ef4444",PATCH:"#a855f7"},Yn="#94a3b8";function Gn(e){return Vn[e]??Yn}function Jn(e){return e===0?"#ef4444":e<300?"#22c55e":e<400?"#3b82f6":e<500?"#eab308":"#ef4444"}function xt(e){return e===0?"rgba(239, 68, 68, 0.15)":e<300?"rgba(34, 197, 94, 0.15)":e<400?"rgba(59, 130, 246, 0.15)":e<500?"rgba(234, 179, 8, 0.15)":"rgba(239, 68, 68, 0.15)"}function mt(e){const t=new Date(e),n=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),i=String(t.getSeconds()).padStart(2,"0"),r=String(t.getMilliseconds()).padStart(3,"0");return`${n}:${o}:${i}.${r}`}function yt(e){return e<1e3?`${e}ms`:`${(e/1e3).toFixed(1)}s`}function bt(e){return e===0?"0 B":e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function Kn(e,t){return e.length<=t?e:e.slice(0,t-3)+"..."}const Zn={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden"},Qn={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",gap:"6px",flexShrink:"0"},eo={fontSize:"10px",color:p.textMuted,flexShrink:"0"},to={padding:"3px 8px",borderRadius:"4px",border:"none",backgroundColor:p.toolBtnBg,color:p.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",flexShrink:"0"},no={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"0 4px 4px"},oo={display:"flex",flexDirection:"column",padding:"5px 6px",borderRadius:"4px",marginBottom:"2px",fontSize:"11px",fontFamily:"monospace",cursor:"pointer",transition:"background-color 0.1s ease"},ro={display:"flex",alignItems:"center",gap:"6px",minWidth:"0"},so={padding:"1px 5px",borderRadius:"3px",fontSize:"9px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flexShrink:"0",color:"#fff"},io={padding:"1px 4px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",flexShrink:"0"},lo={flex:"1",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:p.text,fontSize:"10px",minWidth:"0"},ao={fontSize:"10px",color:p.textMuted,flexShrink:"0",textAlign:"right",minWidth:"40px"},co={fontSize:"10px",color:p.textMuted,flexShrink:"0"},uo={marginTop:"6px",padding:"6px 8px",borderRadius:"4px",backgroundColor:"rgba(0, 0, 0, 0.25)",fontSize:"10px",fontFamily:"monospace",lineHeight:"1.5",wordBreak:"break-all"},Ee={fontWeight:"600",color:p.textBright,marginBottom:"2px",marginTop:"6px",display:"block"},po={color:p.textMuted},St={display:"flex",gap:"4px",color:p.textMuted,padding:"1px 0"},vt={color:"#93c5fd",flexShrink:"0"},fo={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:p.textMuted,fontSize:"12px"};function go({entry:e}){const t=Object.entries(e.requestHeaders),n=Object.entries(e.responseHeaders);return s("div",{style:uo},s("span",{style:{...Ee,marginTop:"0"}},"General"),s("div",{style:po},s("div",null,`URL: ${e.url}`),s("div",null,`Method: ${e.method}`),s("div",null,`Status: ${e.status} ${e.statusText}`),s("div",null,`Duration: ${yt(e.duration)}`),s("div",null,`Request size: ${bt(e.requestSize)}`),s("div",null,`Response size: ${bt(e.responseSize)}`),s("div",null,`Time: ${mt(e.timestamp)}`)),t.length>0?s("div",null,s("span",{style:Ee},"Request Headers"),t.map(([o,i])=>s("div",{key:o,style:St},s("span",{style:vt},`${o}:`),s("span",null,i)))):null,n.length>0?s("div",null,s("span",{style:Ee},"Response Headers"),n.map(([o,i])=>s("div",{key:o,style:St},s("span",{style:vt},`${o}:`),s("span",null,i)))):null)}function ho(){const[e,t]=b(J),[n,o]=b(null);O(()=>_t(()=>{t(J())}),[]);const i=k(()=>{Un(),t([]),o(null)},[]),r=k(l=>{o(c=>c===l?null:l)},[]);return s("div",{style:Zn},s("div",{style:Qn},s("span",{style:eo},`${e.length} request${e.length!==1?"s":""}`),s("button",{style:to,onClick:i,title:"Clear network entries"},"Clear")),e.length===0?s("div",{style:fo},"No network requests"):s("div",{style:no},e.map(l=>{const c=n===l.id;return s("div",{key:l.id,style:{...oo,backgroundColor:c?"rgba(59, 130, 246, 0.12)":xt(l.status)},onClick:()=>r(l.id)},s("div",{style:ro},s("span",{style:{...so,backgroundColor:Gn(l.method)}},l.method),s("span",{style:{...io,color:Jn(l.status),backgroundColor:xt(l.status)}},l.status===0?"ERR":String(l.status)),s("span",{style:lo,title:l.url},Kn(l.url,40)),s("span",{style:ao},yt(l.duration)),s("span",{style:co},mt(l.timestamp))),c?s(go,{entry:l}):null)})))}const _o=100;let wt=1;const K=[],Z=[];let Be=null;function kt(e){Be=e}function Ct(e){K.length>=_o&&K.shift(),K.push(e);for(const t of Z)t();Be&&Be(e)}function Q(){return[...K]}function xo(){K.length=0;for(const e of Z)e()}function $t(e){return Z.push(e),()=>{const t=Z.indexOf(e);t!==-1&&Z.splice(t,1)}}function mo(){const e=window.onerror;window.onerror=(t,n,o,i,r)=>{const l={id:wt++,message:typeof t=="string"?t:"Unknown error",stack:r?.stack??"",source:n??"",line:o??0,col:i??0,timestamp:Date.now(),type:"error"};return Ct(l),typeof e=="function"?e(t,n,o,i,r):!1},window.addEventListener("unhandledrejection",t=>{const n=t.reason,o=n instanceof Error,i=o?n.message:typeof n=="string"?n:"Unhandled promise rejection",r=o?n.stack??"":"",l={id:wt++,message:i,stack:r,source:"",line:0,col:0,timestamp:Date.now(),type:"unhandledrejection"};Ct(l)})}const yo="#ef4444",bo="rgba(239, 68, 68, 0.15)",So="#f97316",vo="rgba(249, 115, 22, 0.15)",wo={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden"},ko={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",gap:"6px",flexShrink:"0"},Co={fontSize:"10px",color:p.textMuted,flexShrink:"0"},$o={padding:"3px 8px",borderRadius:"4px",border:"none",backgroundColor:p.toolBtnBg,color:p.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",flexShrink:"0"},Eo={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"0 4px 4px"},Bo={display:"flex",flexDirection:"column",gap:"2px",padding:"4px 6px",borderRadius:"4px",marginBottom:"2px",fontSize:"11px",fontFamily:"monospace",wordBreak:"break-all",cursor:"pointer"},To={display:"flex",alignItems:"center",gap:"6px"},Ro={padding:"1px 5px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px",flexShrink:"0",color:"#fff"},Mo={fontSize:"10px",color:p.textMuted,flexShrink:"0"},Et={padding:"1px 0",wordBreak:"break-all"},zo={...Et,opacity:"0.5"},Ho={padding:"3px 8px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"11px",fontWeight:"500",backgroundColor:"#dc2626",color:"#fff"},Lo={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:p.textMuted,fontSize:"12px"};function Do(e){const t=new Date(e),n=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),i=String(t.getSeconds()).padStart(2,"0"),r=String(t.getMilliseconds()).padStart(3,"0");return`${n}:${o}:${i}.${r}`}function Io(e){return e==="error"?yo:So}function Po(e){return e==="error"?bo:vo}function Oo(e){return e?e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0):[]}function Ao(e){return e.includes("node_modules")}function No({onReportBug:e}){const[t,n]=b(Q),[o,i]=b(null);O(()=>$t(()=>{n(Q())}),[]);const r=k(()=>{xo(),n([]),i(null)},[]),l=k(c=>{i(g=>g===c?null:c)},[]);return s("div",{style:wo},s("div",{style:ko},s("span",{style:Co},`${t.length} error${t.length!==1?"s":""}`),s("button",{style:$o,onClick:r,title:"Clear error entries"},"Clear")),t.length===0?s("div",{style:Lo},"No errors captured"):s("div",{style:Eo},t.map(c=>{const g=o===c.id,d=Oo(c.stack);return s("div",{key:c.id,style:{...Bo,backgroundColor:g?"rgba(239, 68, 68, 0.12)":Po(c.type)},onClick:()=>l(c.id)},s("div",{style:To},s("span",{style:{...Ro,backgroundColor:Io(c.type)}},c.type==="error"?"ERR":"REJ"),s("span",{style:{flex:"1",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:p.text,fontSize:"10px"}},c.message),s("span",{style:Mo},Do(c.timestamp))),g?s("div",{style:{marginTop:"6px",padding:"6px 8px",borderRadius:"4px",backgroundColor:"rgba(0, 0, 0, 0.25)",fontSize:"10px",fontFamily:"monospace",lineHeight:"1.5"}},c.source?s("div",{style:{color:"#93c5fd",marginBottom:"4px"}},`${c.source}:${c.line}:${c.col}`):null,d.length>0?d.map((f,a)=>s("div",{key:a,style:Ao(f)?zo:Et},f)):s("span",{style:{color:p.textMuted}},"No stack trace available"),e?s("button",{style:{...Ho,marginTop:"8px",width:"100%"},onClick:f=>{f.stopPropagation(),e(c)}},"Report Bug"):null):null)})))}const Fo=["low","medium","high","critical"],Wo={low:"#22c55e",medium:"#eab308",high:"#f97316",critical:"#ef4444"},Bt={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden",padding:"8px",gap:"8px",boxSizing:"border-box"},ue={fontSize:"11px",fontWeight:"600",color:p.textBright,marginBottom:"3px",display:"block"},Tt={width:"100%",padding:"6px 8px",borderRadius:"4px",border:`1px solid ${p.panelBorder}`,backgroundColor:"rgba(0, 0, 0, 0.3)",color:p.text,fontSize:"12px",fontFamily:"system-ui, -apple-system, sans-serif",outline:"none",boxSizing:"border-box"},jo={...Tt,minHeight:"60px",resize:"vertical",lineHeight:"1.4"},Uo={display:"flex",gap:"4px"},qo={padding:"4px 8px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"11px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.3px",flex:"1",textAlign:"center"},Te={padding:"8px 16px",borderRadius:"6px",border:"none",backgroundColor:p.fabBg,color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"600",width:"100%",marginTop:"4px"},Xo={...Te,opacity:"0.5",cursor:"not-allowed"},Rt={padding:"8px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:"500",textAlign:"center"},Vo={...Rt,backgroundColor:"rgba(34, 197, 94, 0.15)",color:"#22c55e",border:"1px solid rgba(34, 197, 94, 0.3)"},Yo={...Rt,backgroundColor:"rgba(239, 68, 68, 0.15)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)"},Go={fontSize:"10px",fontFamily:"monospace",color:p.textMuted,backgroundColor:"rgba(0, 0, 0, 0.3)",padding:"6px 8px",borderRadius:"4px",maxHeight:"60px",overflowY:"auto",lineHeight:"1.4",whiteSpace:"pre-wrap",wordBreak:"break-all"},Mt={padding:"4px 8px",borderRadius:"4px",border:"none",backgroundColor:"rgba(255, 255, 255, 0.1)",color:p.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",alignSelf:"flex-end"};function zt({apiClient:e,projectId:t,prefillTitle:n,prefillStack:o,onClose:i}){const[r,l]=b(n??""),[c,g]=b(""),[d,f]=b("medium"),[a,u]=b("idle"),[h,S]=b(""),C=r.trim().length>0&&a!=="submitting",w=k(async()=>{if(C){u("submitting"),S("");try{const x={projectId:t,title:r.trim(),description:c.trim(),severity:d,url:window.location.href,userAgent:navigator.userAgent,timestamp:Date.now()};o&&(x.stackTrace=o),await e.createBug(x),u("success"),l(""),g(""),f("medium")}catch(x){u("error");const m=x instanceof Error?x.message:"Failed to submit bug report";S(m)}}},[C,r,c,d,t,o,e]);return a==="success"?s("div",{style:Bt},s("div",{style:Vo},"Bug report submitted."),s("button",{style:{...Te,marginTop:"8px"},onClick:()=>u("idle")},"Report Another"),i?s("button",{style:{...Mt,marginTop:"4px",alignSelf:"center"},onClick:i},"Close"):null):s("div",{style:Bt},i?s("button",{style:Mt,onClick:i},"Back"):null,s("div",null,s("label",{style:ue},"Title"),s("input",{style:Tt,type:"text",value:r,placeholder:"Describe the bug briefly",onInput:x=>{l(x.target.value)}})),s("div",null,s("label",{style:ue},"Description"),s("textarea",{style:jo,value:c,placeholder:"Steps to reproduce, expected vs actual behavior",onInput:x=>{g(x.target.value)}})),o?s("div",null,s("label",{style:ue},"Stack Trace"),s("div",{style:Go},o)):null,s("div",null,s("label",{style:ue},"Severity"),s("div",{style:Uo},Fo.map(x=>s("button",{key:x,style:{...qo,backgroundColor:d===x?Wo[x]:p.toolBtnBg,color:d===x?"#fff":p.textMuted},onClick:()=>f(x)},x)))),a==="error"?s("div",{style:Yo},h||"Submission failed"):null,s("button",{style:C?Te:Xo,onClick:w,disabled:!C},a==="submitting"?"Submitting...":"Submit Bug Report"))}const Jo={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden",padding:"8px",gap:"8px",boxSizing:"border-box"},Ko={display:"flex",gap:"6px",flexShrink:"0"},Zo={flex:"1",padding:"6px 8px",borderRadius:"4px",border:`1px solid ${p.panelBorder}`,backgroundColor:"rgba(0, 0, 0, 0.3)",color:p.text,fontSize:"12px",fontFamily:"system-ui, -apple-system, sans-serif",outline:"none",boxSizing:"border-box"},Ht={padding:"6px 10px",borderRadius:"4px",border:"none",backgroundColor:p.fabBg,color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"600",flexShrink:"0"},Qo={...Ht,opacity:"0.5",cursor:"not-allowed"},Lt={flex:"1",overflowY:"auto",fontSize:"12px",lineHeight:"1.5",color:p.text,whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"rgba(0, 0, 0, 0.2)",padding:"8px",borderRadius:"4px",minHeight:"80px"},er={...Lt,color:p.textMuted,display:"flex",alignItems:"center",justifyContent:"center",fontStyle:"italic"},tr={padding:"8px",fontSize:"12px",color:"#ef4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"4px"};function nr({apiBase:e,pinHash:t}){const[n,o]=b(""),[i,r]=b(""),[l,c]=b("idle"),[g,d]=b(""),f=F(null),a=n.trim().length>0&&l!=="loading"&&l!=="streaming",u=k(async()=>{if(!a)return;const S=n.trim();r(""),c("loading"),d(""),f.current&&f.current.abort();const C=new AbortController;f.current=C;try{const w=await fetch(`${e}/api/ai/analyze`,{method:"POST",headers:{"Content-Type":"application/json","X-DevTools-Pin":t},body:JSON.stringify({text:S,context:window.location.href}),signal:C.signal});if(!w.ok)throw new Error(`Request failed (${w.status})`);const x=w.body?.getReader();if(!x)throw new Error("No response stream");c("streaming");const m=new TextDecoder;for(;;){const{done:B,value:y}=await x.read();if(B)break;const T=m.decode(y,{stream:!0});T&&r(H=>H+T)}c("idle")}catch(w){if(w.name==="AbortError")return;c("error");const x=w instanceof Error?w.message:"Analysis failed";d(x)}},[a,n,e,t]),h=k(S=>{S.key==="Enter"&&!S.shiftKey&&a&&(S.preventDefault(),u())},[a,u]);return s("div",{style:Jo},s("div",{style:Ko},s("input",{style:Zo,type:"text",value:n,placeholder:"Ask about code, errors, concepts...",onInput:S=>{o(S.target.value)},onKeyDown:h}),s("button",{style:a?Ht:Qo,onClick:u,disabled:!a},l==="loading"||l==="streaming"?"...":"Send")),l==="error"?s("div",{style:tr},g):null,i?s("div",{style:Lt},i):s("div",{style:er},l==="loading"?"Thinking...":"Response will appear here"))}const or=100,rr={LCP:[2500,4e3],CLS:[.1,.25],INP:[200,500],FCP:[1800,3e3],TTFB:[800,1800]};let sr=1;const ee=[],pe=[];function ir(e,t){const n=rr[e];return t<=n[0]?"good":t<=n[1]?"needs-improvement":"poor"}function te(e,t){const n={id:sr++,timestamp:Date.now(),metric:e,value:Math.round(e==="CLS"?t*1e3:t)/(e==="CLS"?1e3:1),rating:ir(e,t)};ee.length>=or&&ee.shift(),ee.push(n);for(const o of pe)o(n)}function Dt(){return[...ee]}function lr(){ee.length=0}function It(e){return pe.push(e),()=>{const t=pe.indexOf(e);t!==-1&&pe.splice(t,1)}}function ar(){if(!(typeof PerformanceObserver>"u")){try{new PerformanceObserver(t=>{const n=t.getEntries(),o=n[n.length-1];o&&te("LCP",o.startTime)}).observe({type:"largest-contentful-paint",buffered:!0})}catch{}try{let e=0;new PerformanceObserver(n=>{for(const o of n.getEntries()){const i=o;!i.hadRecentInput&&typeof i.value=="number"&&(e+=i.value,te("CLS",e))}}).observe({type:"layout-shift",buffered:!0})}catch{}try{new PerformanceObserver(t=>{for(const n of t.getEntries())n.duration>0&&te("INP",n.duration)}).observe({type:"event",buffered:!0})}catch{}try{new PerformanceObserver(t=>{for(const n of t.getEntries())n.name==="first-contentful-paint"&&te("FCP",n.startTime)}).observe({type:"paint",buffered:!0})}catch{}try{new PerformanceObserver(t=>{for(const n of t.getEntries()){const o=n;o.responseStart>0&&te("TTFB",o.responseStart-o.requestStart)}}).observe({type:"navigation",buffered:!0})}catch{}}}const Re={good:"#22c55e","needs-improvement":"#eab308",poor:"#ef4444"},cr={good:"rgba(34, 197, 94, 0.15)","needs-improvement":"rgba(234, 179, 8, 0.15)",poor:"rgba(239, 68, 68, 0.15)"},dr={LCP:"Largest Contentful Paint",CLS:"Cumulative Layout Shift",INP:"Interaction to Next Paint",FCP:"First Contentful Paint",TTFB:"Time to First Byte"},Pt={LCP:"ms",CLS:"",INP:"ms",FCP:"ms",TTFB:"ms"},ur=["LCP","FCP","CLS","INP","TTFB"];function pr(e){const t=new Date(e),n=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),i=String(t.getSeconds()).padStart(2,"0");return`${n}:${o}:${i}`}function fr(e){const t={};for(const n of e){const o=t[n.metric];(!o||n.id>o.id)&&(t[n.metric]=n)}return t}const gr={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden"},hr={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",flexShrink:"0"},_r={fontSize:"11px",fontWeight:"600",color:p.textBright,textTransform:"uppercase",letterSpacing:"0.5px"},xr={padding:"3px 8px",borderRadius:"4px",border:"none",backgroundColor:p.toolBtnBg,color:p.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",flexShrink:"0"},mr={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"6px",padding:"4px 8px 8px",flexShrink:"0"},yr={display:"flex",flexDirection:"column",alignItems:"center",gap:"2px",padding:"8px 6px",borderRadius:"6px",backgroundColor:p.toolBtnBg},br={fontSize:"16px",fontWeight:"700",fontFamily:"monospace"},Sr={fontSize:"9px",fontWeight:"500",color:p.textMuted,textTransform:"uppercase",letterSpacing:"0.3px"},vr={height:"1px",backgroundColor:p.panelBorder,margin:"0 8px",flexShrink:"0"},wr={fontSize:"10px",fontWeight:"600",color:p.textMuted,padding:"6px 8px 2px",textTransform:"uppercase",letterSpacing:"0.5px",flexShrink:"0"},kr={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"0 4px 4px"},Cr={display:"flex",alignItems:"center",gap:"6px",padding:"4px 6px",borderRadius:"4px",marginBottom:"2px",fontSize:"11px",fontFamily:"monospace"},$r={padding:"1px 5px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.3px",flexShrink:"0",color:"#fff"},Er={fontWeight:"600",color:p.text,flexShrink:"0",minWidth:"32px"},Br={color:p.textBright,flex:"1"},Tr={fontSize:"10px",color:p.textMuted,flexShrink:"0"},Rr={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:p.textMuted,fontSize:"12px"};function Mr(e){return e==="good"?"Good":e==="needs-improvement"?"OK":"Poor"}function zr(){const[e,t]=b(Dt);O(()=>It(()=>{t(Dt())}),[]);const n=k(()=>{lr(),t([])},[]),o=fr(e),i=ur.map(r=>{const l=o[r];if(!l)return null;const c=Pt[r],g=r==="CLS"?l.value.toFixed(3):`${Math.round(l.value)}`;return{metric:r,entry:l,displayValue:g,unit:c}}).filter(Boolean);return s("div",{style:gr},s("div",{style:hr},s("span",{style:_r},"Web Vitals"),s("button",{style:xr,onClick:n,title:"Clear performance entries"},"Clear")),i.length>0?s("div",{style:mr},i.map(r=>s("div",{key:r.metric,style:{...yr,borderLeft:`3px solid ${Re[r.entry.rating]}`},title:dr[r.metric]},s("span",{style:{...br,color:Re[r.entry.rating]}},`${r.displayValue}${r.unit}`),s("span",{style:Sr},r.metric)))):null,e.length>0?s("div",{style:vr}):null,e.length>0?s("div",{style:wr},"Event Log"):null,e.length===0?s("div",{style:Rr},"Waiting for Web Vitals data..."):s("div",{style:kr},[...e].reverse().map(r=>{const l=Pt[r.metric],c=r.metric==="CLS"?r.value.toFixed(3):`${Math.round(r.value)}`;return s("div",{key:r.id,style:{...Cr,backgroundColor:cr[r.rating]}},s("span",{style:{...$r,backgroundColor:Re[r.rating]}},Mr(r.rating)),s("span",{style:Er},r.metric),s("span",{style:Br},`${c}${l}`),s("span",{style:Tr},pr(r.timestamp)))})))}const Me="devtools-debug-snapshots",Hr=5;function Lr(){try{const e=localStorage.getItem(Me);return e?JSON.parse(e):[]}catch{return[]}}function Ot(e){try{localStorage.setItem(Me,JSON.stringify(e))}catch{}}let Dr=1;function ne(e){return String(e).padStart(2,"0")}function At(e){const t=new Date(e);return`${ne(t.getHours())}:${ne(t.getMinutes())}:${ne(t.getSeconds())}`}function Ir(){const e=[];try{const t=Object.keys(localStorage).filter(n=>n!==Me);if(t.length){const n=t.slice(0,30).map(o=>{const i=localStorage.getItem(o)??"";return`  ${o}: ${i.length>120?i.slice(0,120)+"…":i}`});e.push(`localStorage (${t.length} keys):
${n.join(`
`)}`)}}catch{}try{const t=Object.keys(sessionStorage);if(t.length){const n=t.slice(0,30).map(o=>{const i=sessionStorage.getItem(o)??"";return`  ${o}: ${i.length>120?i.slice(0,120)+"…":i}`});e.push(`sessionStorage (${t.length} keys):
${n.join(`
`)}`)}}catch{}return e.length?e.join(`

`):"(empty)"}function Pr(){try{const t=performance.getEntriesByType("navigation")[0];return t?[`DNS: ${Math.round(t.domainLookupEnd-t.domainLookupStart)}ms`,`Connect: ${Math.round(t.connectEnd-t.connectStart)}ms`,`TTFB: ${Math.round(t.responseStart-t.requestStart)}ms`,`DOM Ready: ${Math.round(t.domContentLoadedEventEnd)}ms`,`Page Load: ${Math.round(t.loadEventEnd)}ms`].join(" | "):"(not available)"}catch{return"(not available)"}}function Or(){try{const e=document.cookie.split(";").map(t=>t.trim().split("=")[0]).filter(Boolean);return e.length?e.join(", "):"(none)"}catch{return"(unavailable)"}}function Ar(e,t){const o=new Date().toISOString().replace("T"," ").slice(0,19),i=V(),r=J(),l=Q(),c=t?i.filter(u=>u.level==="error"||u.level==="warn"):[...i],g=t?r.filter(u=>u.status===0||u.status>=400):[...r],d=[];d.push(`# Debug Snapshot — ${o}`),d.push(""),d.push(`**URL:** ${window.location.href}`),document.title&&d.push(`**Page:** ${document.title}`),d.push(`**Viewport:** ${window.innerWidth} x ${window.innerHeight}`),d.push(`**User-Agent:** ${navigator.userAgent}`),d.push(`**Cookies:** ${Or()}`),d.push(""),e.length&&(d.push(`## Screenshots (${e.length} downloaded)`),d.push(e.map(u=>u.name).join(", ")),d.push(""));const f=t?`${c.length} warnings/errors of ${i.length} total`:`${c.length} entries`;if(d.push(`## Console — ${f}`),!c.length)d.push("(none)");else for(const u of c.slice(-60))d.push(`[${At(u.timestamp)}] ${u.level.toUpperCase().padEnd(5)} ${u.args.join(" ")}`);d.push("");const a=t?`${g.length} errors of ${r.length} total`:`${g.length} requests`;if(d.push(`## Network — ${a}`),!g.length)d.push("(none)");else for(const u of g.slice(-40)){const h=u.status===0?"ERR":String(u.status);d.push(`${u.method.padEnd(6)} ${u.url} — ${h} (${u.duration}ms)`)}if(d.push(""),d.push(`## JavaScript Errors — ${l.length}`),!l.length)d.push("(none)");else for(const u of l){const h=u.type==="unhandledrejection"?"UnhandledRejection":"Error";if(d.push(`[${At(u.timestamp)}] ${h}: ${u.message}`),u.source&&d.push(`  at ${u.source}:${u.line}:${u.col}`),u.stack){const S=u.stack.split(`
`).slice(1,7).map(C=>C.trim()).filter(Boolean);for(const C of S)d.push(`  ${C}`)}}return d.push(""),d.push("## Storage"),d.push(Ir()),d.push(""),d.push("## Page Timing"),d.push(Pr()),d.join(`
`)}async function Nr(){const e=await navigator.mediaDevices.getDisplayMedia({video:{displaySurface:"browser"},preferCurrentTab:!0}),t=document.createElement("video");t.srcObject=e,t.muted=!0,await new Promise(r=>{t.onloadedmetadata=()=>{t.play().then(r).catch(r)}}),await new Promise(r=>setTimeout(r,120));const n=document.createElement("canvas");n.width=t.videoWidth||window.innerWidth,n.height=t.videoHeight||window.innerHeight;const o=n.getContext("2d");let i=null;return o&&(o.drawImage(t,0,0,n.width,n.height),i=await new Promise(r=>n.toBlob(r,"image/png"))),e.getTracks().forEach(r=>r.stop()),t.srcObject=null,i}const Fr={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden",boxSizing:"border-box"},Wr={display:"flex",flexShrink:"0",borderBottom:`1px solid ${p.panelBorder}`};function Nt(e){return{flex:"1",padding:"7px 4px",border:"none",borderBottom:e?`2px solid ${p.fabBg}`:"2px solid transparent",backgroundColor:"transparent",color:e?p.textBright:p.textMuted,fontSize:"11px",fontWeight:"600",cursor:"pointer",transition:"color 0.1s",boxSizing:"border-box"}}const Ft={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"8px",display:"flex",flexDirection:"column",gap:"8px",boxSizing:"border-box"},Wt={fontSize:"10px",fontWeight:"600",color:p.textMuted,textTransform:"uppercase",letterSpacing:"0.4px",marginBottom:"4px",display:"block"},jr={display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"4px"};function ze(e,t){return{padding:"6px",borderRadius:"4px",backgroundColor:e>0?`${t}22`:p.toolBtnBg,border:`1px solid ${e>0?t:p.panelBorder}`,textAlign:"center"}}const He={fontSize:"16px",fontWeight:"700",color:p.textBright,display:"block"},Le={fontSize:"9px",color:p.textMuted,textTransform:"uppercase",letterSpacing:"0.3px"},Ur={border:`1px dashed ${p.panelBorder}`,borderRadius:"6px",padding:"10px",minHeight:"64px",display:"flex",flexDirection:"column",gap:"6px"},qr={display:"flex",flexWrap:"wrap",gap:"4px"},Xr={position:"relative",width:"56px",height:"40px",borderRadius:"3px",overflow:"hidden",flexShrink:"0",border:`1px solid ${p.panelBorder}`,cursor:"default"},Vr={width:"100%",height:"100%",objectFit:"cover"},Yr={position:"absolute",top:"1px",right:"1px",width:"14px",height:"14px",borderRadius:"2px",border:"none",backgroundColor:"rgba(0,0,0,0.7)",color:"#fff",fontSize:"9px",lineHeight:"1",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},Gr={fontSize:"11px",color:p.textMuted,textAlign:"center"},jt={display:"flex",gap:"4px"};function fe(e="muted"){const t=e==="primary"?p.fabBg:e==="danger"?"#7f1d1d":p.toolBtnBg,n=e==="primary"?"#fff":e==="danger"?"#fca5a5":p.textMuted;return{flex:"1",padding:"5px 8px",borderRadius:"4px",border:"none",backgroundColor:t,color:n,fontSize:"11px",fontWeight:"500",cursor:"pointer",whiteSpace:"nowrap"}}const Jr=e=>({width:"100%",padding:"9px 12px",borderRadius:"6px",border:"none",backgroundColor:e?"#1e293b":p.fabBg,color:e?p.textMuted:"#fff",fontSize:"12px",fontWeight:"600",cursor:e?"not-allowed":"pointer"}),Kr=e=>({padding:"3px 8px",borderRadius:"4px",border:`1px solid ${e?p.fabBg:p.panelBorder}`,backgroundColor:e?`${p.fabBg}33`:"transparent",color:e?"#93c5fd":p.textMuted,fontSize:"10px",cursor:"pointer",fontWeight:"500"}),Zr={borderRadius:"6px",border:`1px solid ${p.panelBorder}`,backgroundColor:p.toolBtnBg,padding:"8px",display:"flex",flexDirection:"column",gap:"4px"},Qr={fontSize:"10px",color:p.text,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},es={fontSize:"10px",color:p.textMuted},ts={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:p.textMuted,fontSize:"12px",padding:"20px",textAlign:"center"};function ns(){const[e,t]=b("capture"),[n,o]=b([]),[i,r]=b(Lr),[l,c]=b(!1),[g,d]=b(null),[f,a]=b(!0);O(()=>()=>{for(const _ of n)URL.revokeObjectURL(_.url)},[]),O(()=>{if(e!=="capture")return;function _(v){const $=v.clipboardData?.items;if($){for(const z of Array.from($))if(z.type.startsWith("image/")){const ge=z.getAsFile();ge&&u(ge)}}}return window.addEventListener("paste",_),()=>window.removeEventListener("paste",_)},[e]);function u(_){const v=Dr++,$=URL.createObjectURL(_);o(z=>[...z,{id:v,url:$,blob:_,name:`screenshot-${v}.png`}])}const h=k(async()=>{c(!0);try{const _=await Nr();_&&u(_)}catch{}c(!1)},[]),S=k(_=>{o(v=>{const $=v.find(z=>z.id===_);return $&&URL.revokeObjectURL($.url),v.filter(z=>z.id!==_)})},[]),C=k(()=>{o(_=>{for(const v of _)URL.revokeObjectURL(v.url);return[]})},[]),w=k(_=>{for(const v of _){const $=document.createElement("a");$.href=v.url,$.download=v.name,document.body.appendChild($),$.click(),document.body.removeChild($)}},[]),x=k(_=>{d(_),setTimeout(()=>d(null),2e3)},[]),m=k(async()=>{const _=Ar(n,f);n.length>0&&w(n);const v={id:String(Date.now()),timestamp:Date.now(),pageUrl:window.location.href,report:_};r($=>{const z=[v,...$].slice(0,Hr);return Ot(z),z}),await navigator.clipboard.writeText(_),x(v.id)},[n,f,w,x]),B=k(async _=>{await navigator.clipboard.writeText(_.report),x(_.id)},[x]),y=k(_=>{r(v=>{const $=v.filter(z=>z.id!==_);return Ot($),$})},[]),T=V(),H=J(),I=Q(),D=T.filter(_=>_.level==="error"||_.level==="warn").length,L=H.filter(_=>_.status===0||_.status>=400).length;return s("div",{style:Fr},s("div",{style:Wr},s("button",{style:Nt(e==="capture"),onClick:()=>t("capture")},"Capture"),s("button",{style:Nt(e==="history"),onClick:()=>t("history")},`History (${i.length})`)),e==="capture"?s("div",{style:Ft},s("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},s("span",{style:Wt},"Report data"),s("button",{style:Kr(f),onClick:()=>a(_=>!_)},f?"Errors only":"All entries")),s("div",{style:jr},s("div",{style:ze(D,"#eab308")},s("span",{style:He},String(D)),s("span",{style:Le},"Console")),s("div",{style:ze(L,"#ef4444")},s("span",{style:He},String(L)),s("span",{style:Le},"Net Errors")),s("div",{style:ze(I.length,"#ef4444")},s("span",{style:He},String(I.length)),s("span",{style:Le},"JS Errors"))),s("div",null,s("span",{style:Wt},`Screenshots (${n.length})`),s("div",{style:Ur},n.length===0?s("div",{style:Gr},"Cmd+V to paste a screenshot",s("br",null),"or click Capture below"):s("div",{style:qr},n.map(_=>s("div",{key:_.id,style:Xr,title:_.name},s("img",{src:_.url,style:Vr,alt:_.name}),s("button",{style:Yr,onClick:()=>S(_.id),title:"Remove"},"×")))),s("div",{style:jt},s("button",{style:fe("muted"),onClick:h,disabled:l,title:"Capture current screen (opens share dialog)"},l?"Capturing...":"Capture Screen"),n.length>0?s("button",{style:fe("danger"),onClick:C,title:"Delete all screenshots"},"Delete All"):null))),s("button",{style:Jr(!1),onClick:m,title:"Copy debug report to clipboard. Screenshots (if any) download as files."},g?"Copied!":"Copy Report & Download Screenshots"),s("div",{style:{fontSize:"10px",color:p.textMuted,lineHeight:"1.4"}},"Copies a full markdown report. Screenshots download to your Downloads folder as numbered PNG files. Report saved to History for re-copying.")):s("div",{style:{...Ft,gap:"6px"}},i.length===0?s("div",{style:ts},"No snapshots yet. Copy a report from the Capture tab to save it here."):i.map(_=>{const v=new Date(_.timestamp),$=`${v.toLocaleDateString()} ${ne(v.getHours())}:${ne(v.getMinutes())}`,z=g===_.id;return s("div",{key:_.id,style:Zr},s("div",{style:es},$),s("div",{style:Qr,title:_.pageUrl},_.pageUrl),s("div",{style:jt},s("button",{style:fe(z?"primary":"muted"),onClick:()=>B(_)},z?"Copied!":"Copy Report"),s("button",{style:fe("danger"),onClick:()=>y(_.id)},"Delete")))})))}const Ut=[{id:"debug",label:"Debug Snapshot",icon:"⊚"},{id:"console",label:"Console Viewer",icon:">"},{id:"network",label:"Network Viewer",icon:"⇅"},{id:"errors",label:"Error Log",icon:"⚠"},{id:"bugs",label:"Bug Reporter",icon:"🐛"},{id:"perf",label:"Performance",icon:"⚡"},{id:"ai",label:"AI Assistant",icon:"✨"}];function os({projectId:e,isOpen:t,onClose:n,apiClient:o,apiBase:i,pinHash:r}){const[l,c]=b(null),[g,d]=b(!1),[f,a]=b(null),[u,h]=b(""),[S,C]=b(""),w=k(y=>{c(T=>(T==="bugs"&&y!=="bugs"&&(h(""),C("")),T===y?null:y))},[]),x=k(y=>{h(y.message),C(y.stack),c("bugs")},[]),m=l?Ut.find(y=>y.id===l):null;return s("div",{style:{...dn,transform:t?mn:yn,transition:"transform 0.25s ease",pointerEvents:t?"auto":"none"},"aria-hidden":!t},s("div",{style:un},s("span",{style:pn,title:e},e),s("button",{style:{...fn,backgroundColor:g?p.closeBtnHover:"transparent",color:g?"#fff":p.textMuted},onClick:n,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),"aria-label":"Close panel",title:"Close"},"✕")),s("div",{style:gn},Ut.map(y=>{const T=l===y.id,H=f===y.id;let I=p.toolBtnBg;return T?I=p.toolBtnBgActive:H&&(I=p.toolBtnBgHover),s("button",{key:y.id,style:{...hn,backgroundColor:I,color:T?"#fff":p.text},onClick:()=>w(y.id),onMouseEnter:()=>a(y.id),onMouseLeave:()=>a(null)},s("span",{style:_n},y.icon),s("span",null,y.label))})),m?s("div",{style:{...xn,borderTop:`1px solid ${p.panelBorder}`,...l==="debug"||l==="console"||l==="network"||l==="errors"||l==="bugs"||l==="perf"||l==="ai"?{alignItems:"stretch",justifyContent:"stretch",padding:"0"}:{}}},l==="debug"?s(ns,null):l==="console"?s(Fn,null):l==="network"?s(ho,null):l==="errors"?s(No,{onReportBug:x}):l==="bugs"?s(zt,{apiClient:o,projectId:e,prefillTitle:u||void 0,prefillStack:S||void 0}):l==="perf"?s(zr,null):l==="ai"?s(nr,{apiBase:i,pinHash:r}):s("span",null,`${m.label} -- coming soon`)):null)}const qt={isDragging:!1,startX:0,startY:0,offsetX:0,offsetY:0,moved:!1},rs=s("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},s("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"}));function ss({projectId:e,pinHash:t,apiBase:n,apiClient:o}){const[i,r]=b(!1),[l,c]=b(!1),[g,d]=b({x:0,y:0}),[f,a]=b(!1),u=F(qt),h=F(null),S=k(B=>{B.currentTarget.setPointerCapture(B.pointerId),u.current={isDragging:!0,startX:B.clientX,startY:B.clientY,offsetX:g.x,offsetY:g.y,moved:!1},a(!0)},[g.x,g.y]),C=k(B=>{const y=u.current;if(!y.isDragging)return;const T=B.clientX-y.startX,H=B.clientY-y.startY;Math.sqrt(T*T+H*H)>an&&(u.current={...y,moved:!0}),d({x:y.offsetX+T,y:y.offsetY+H})},[]),w=k(()=>{const y=u.current.moved;u.current={...qt},a(!1),y||r(T=>!T)},[]),x=k(()=>{r(!1)},[]),m={...cn,bottom:`${20-g.y}px`,right:`${20-g.x}px`,backgroundColor:l?p.fabBgHover:p.fabBg,boxShadow:l?`0 6px 16px ${p.shadow}`:`0 4px 12px ${p.shadow}`,cursor:f?"grabbing":"grab"};return s("div",null,s("button",{ref:h,style:m,title:`DevTools (${e})`,"aria-label":"Toggle DevTools panel",onPointerDown:S,onPointerMove:C,onPointerUp:w,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1)},rs),s(os,{projectId:e,isOpen:i,onClose:x,apiClient:o,apiBase:n,pinHash:t}))}function Xt(e,t){async function n(o,i={}){return(await fetch(`${e}${o}`,{...i,headers:{"Content-Type":"application/json","X-DevTools-Pin":t,...i.headers}})).json()}return{createBug:o=>n("/api/bugs",{method:"POST",body:JSON.stringify(o)}),createDevLog:o=>n("/api/devlog",{method:"POST",body:JSON.stringify(o)}),sendEvents:o=>n("/api/widget/event",{method:"POST",body:JSON.stringify({events:o})})}}const is=console.warn.bind(console),ls=1e4,as=50,cs=200,ds=new Set(["log","info","warn","error","debug"]);function us(e,t,n){let o=[];function i(f){o.length>=cs||(o.push(f),o.length>=as&&r())}function r(){if(o.length===0)return;const f=[...o];o=[],t.sendEvents(f).catch(a=>{is("[DevTools] Failed to send events:",a)})}function l(){if(o.length===0)return;const f=[...o];o=[];const a=JSON.stringify({events:f}),u=`${n}/api/widget/event`;try{const h=new Blob([a],{type:"application/json"});navigator.sendBeacon(u,h)}catch{}}let c=0;$t(()=>{const a=Q().filter(u=>u.id>c);if(a.length>0){c=a[a.length-1].id;for(const u of a)i({type:"error",title:u.message,content:u.stack,metadata:{errorType:u.type,source:u.source,line:u.line,col:u.col},projectId:e})}}),It(f=>{i({type:"perf",title:`${f.metric}: ${f.value}`,content:`Rating: ${f.rating}`,metadata:{metric:f.metric,value:f.value,rating:f.rating},projectId:e})});let g=0;ut(()=>{const a=V().filter(u=>u.id>g);if(a.length>0){g=a[a.length-1].id;for(const u of a){if(!ds.has(u.level))continue;const h=u.args.join(" ");h.includes("/api/widget/")||h.includes("/api/ai/analyze")||i({type:"console",title:h.slice(0,500),content:u.args.join(`
`).slice(0,2e3),metadata:{level:u.level,argCount:u.args.length},projectId:e})}}});let d=0;_t(()=>{const a=J().filter(u=>u.id>d);if(a.length>0){d=a[a.length-1].id;for(const u of a)u.url.includes("/api/widget/")||u.url.includes("/api/bugs")||u.url.includes("/api/ai/analyze")||i({type:"network",title:`${u.method} ${u.url}`.slice(0,500),content:`${u.status} ${u.statusText} (${u.duration}ms)`,metadata:{method:u.method,url:u.url,status:u.status,statusText:u.statusText,duration:u.duration,requestSize:u.requestSize,responseSize:u.responseSize},projectId:e})}}),setInterval(r,ls),window.addEventListener("beforeunload",l)}function ps(e,t,n){$n(),Xn(),mo(),ar();const o=Xt(n,t);us(e,o,n)}const fs=1e4,gs={position:"fixed",bottom:"80px",right:"20px",width:"340px",maxHeight:"280px",backgroundColor:"#1a0000",border:"1px solid #dc2626",borderRadius:"8px",boxShadow:"0 8px 24px rgba(220, 38, 38, 0.3)",zIndex:"999997",fontFamily:"system-ui, -apple-system, sans-serif",color:p.text,overflow:"hidden",display:"flex",flexDirection:"column"},hs={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:"rgba(220, 38, 38, 0.2)",borderBottom:"1px solid #dc2626",flexShrink:"0"},_s={fontSize:"12px",fontWeight:"600",color:"#fca5a5"},xs={display:"flex",gap:"6px"},Vt={padding:"3px 8px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"11px",fontWeight:"500"},ms={...Vt,backgroundColor:"#dc2626",color:"#fff"},ys={...Vt,backgroundColor:"rgba(255, 255, 255, 0.1)",color:p.textMuted},bs={padding:"8px 12px",overflowY:"auto",flex:"1"},Ss={fontSize:"12px",fontWeight:"500",color:"#fca5a5",marginBottom:"6px",wordBreak:"break-word"},vs={fontSize:"10px",fontFamily:"monospace",lineHeight:"1.6",color:p.textMuted},Yt={padding:"1px 0",wordBreak:"break-all"},ws={...Yt,opacity:"0.5"};function ks(e){return e?e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0):[]}function Cs(e){return e.includes("node_modules")}function $s({onReportBug:e}){const[t,n]=b(null),o=F(null),i=k(()=>{n(null),o.current&&(clearTimeout(o.current),o.current=null)},[]),r=k(()=>{o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{n(null),o.current=null},fs)},[]);O(()=>(kt(f=>{n(f),r()}),()=>{kt(null),o.current&&clearTimeout(o.current)}),[r]);const l=k(()=>{o.current&&(clearTimeout(o.current),o.current=null)},[]),c=k(()=>{t&&r()},[t,r]),g=k(()=>{t&&(e(t),i())},[t,e,i]);if(!t)return null;const d=ks(t.stack);return s("div",{style:gs,onMouseEnter:l,onMouseLeave:c},s("div",{style:hs},s("span",{style:_s},t.type==="error"?"Uncaught Error":"Unhandled Rejection"),s("div",{style:xs},s("button",{style:ms,onClick:g},"Report Bug"),s("button",{style:ys,onClick:i},"Dismiss"))),s("div",{style:bs},s("div",{style:Ss},t.message),d.length>0?s("div",{style:vs},d.slice(0,8).map((f,a)=>s("div",{key:a,style:Cs(f)?ws:Yt},f))):null))}const Es={position:"fixed",padding:"6px 12px",borderRadius:"6px",border:"none",backgroundColor:p.fabBg,color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"600",zIndex:999999,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)",display:"flex",alignItems:"center",gap:"4px",fontFamily:"system-ui, -apple-system, sans-serif"},Bs={position:"fixed",width:"360px",maxHeight:"320px",backgroundColor:p.panelBg,border:`1px solid ${p.panelBorder}`,borderRadius:"8px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",zIndex:999999,display:"flex",flexDirection:"column",fontFamily:"system-ui, -apple-system, sans-serif",overflow:"hidden"},Ts={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:p.panelHeaderBg,borderBottom:`1px solid ${p.panelBorder}`,flexShrink:0},Rs={fontSize:"12px",fontWeight:"600",color:p.textBright},Ms={width:"24px",height:"24px",borderRadius:"4px",border:"none",backgroundColor:"transparent",color:p.textMuted,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",lineHeight:"1"},zs={padding:"12px",overflowY:"auto",flex:1,fontSize:"13px",lineHeight:"1.5",color:p.text,whiteSpace:"pre-wrap",wordBreak:"break-word"},Hs={padding:"16px 12px",fontSize:"12px",color:p.textMuted,textAlign:"center"},Ls={padding:"12px",fontSize:"12px",color:"#ef4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"4px",margin:"8px 12px"};function Gt(e,t,n,o){const i=Math.min(Math.max(e,8),window.innerWidth-n-8),r=Math.min(Math.max(t,8),window.innerHeight-o-8);return{x:i,y:r}}function Ds({apiBase:e,pinHash:t}){const[n,o]=b(""),[i,r]=b(null),[l,c]=b(null),[g,d]=b("idle"),[f,a]=b(""),[u,h]=b(""),[S,C]=b(!1),[w,x]=b(!1),m=F(null),B=F(null),y=k(()=>{r(null),c(null),o(""),d("idle"),a(""),h(""),m.current&&(m.current.abort(),m.current=null)},[]);O(()=>{function D(L){if(L.target.closest?.("[data-quickai]"))return;const $=window.getSelection()?.toString().trim()??"";if($.length>10){o($);const z=Gt(L.clientX,L.clientY-40,90,30);r(z)}else l||(r(null),o(""))}return document.addEventListener("mouseup",D),()=>document.removeEventListener("mouseup",D)},[l]),O(()=>{if(!l)return;function D(_){_.target.closest?.("[data-quickai]")||y()}const L=setTimeout(()=>{document.addEventListener("mousedown",D)},100);return()=>{clearTimeout(L),document.removeEventListener("mousedown",D)}},[l,y]);const T=k(async()=>{if(!n)return;const D=i?Gt(i.x,i.y+36,360,320):{x:100,y:100};c(D),r(null),d("loading"),a(""),h(""),m.current&&m.current.abort();const L=new AbortController;m.current=L;try{const _=await fetch(`${e}/api/ai/analyze`,{method:"POST",headers:{"Content-Type":"application/json","X-DevTools-Pin":t},body:JSON.stringify({text:n,context:window.location.href}),signal:L.signal});if(!_.ok)throw new Error(`Analysis failed (${_.status})`);const v=_.body?.getReader();if(!v)throw new Error("No response stream");d("streaming");const $=new TextDecoder;for(;;){const{done:z,value:ge}=await v.read();if(z)break;const Kt=$.decode(ge,{stream:!0});Kt&&a(Os=>Os+Kt)}d("done")}catch(_){if(_.name==="AbortError")return;d("error");const v=_ instanceof Error?_.message:"Analysis failed";h(v)}},[n,i,e,t]),H=i?s("button",{"data-quickai":"btn",style:{...Es,left:`${i.x}px`,top:`${i.y}px`,backgroundColor:S?p.fabBgHover:p.fabBg},onClick:T,onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1)},"✨ Analyze"):null,I=l?s("div",{ref:B,"data-quickai":"popup",style:{...Bs,left:`${l.x}px`,top:`${l.y}px`}},s("div",{style:Ts},s("span",{style:Rs},"AI Analysis"),s("button",{style:{...Ms,backgroundColor:w?p.closeBtnHover:"transparent",color:w?"#fff":p.textMuted},onClick:y,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),"aria-label":"Close"},"✕")),g==="loading"?s("div",{style:Hs},"Analyzing..."):g==="error"?s("div",{style:Ls},u):s("div",{style:zs},f||"Waiting...")):null;return s("div",{"data-quickai":"root"},H,I)}const De=document.currentScript,Is=[":host { all: initial; }","#devtools-root { font-family: system-ui, sans-serif; }"].join(`
`);function Ps({projectId:e,pinHash:t,apiBase:n,apiClient:o}){const[i,r]=b(null),l=k(g=>{r(g)},[]),c=k(()=>{r(null)},[]);return s("div",null,s(ss,{projectId:e,pinHash:t,apiBase:n,apiClient:o}),s($s,{onReportBug:l}),s(Ds,{apiBase:n,pinHash:t}),i?s("div",{style:{position:"fixed",bottom:"80px",right:"20px",width:"340px",maxHeight:"400px",backgroundColor:"#0f172a",border:"1px solid #1e293b",borderRadius:"8px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",zIndex:"999997",overflow:"auto"}},s(zt,{apiClient:o,projectId:e,prefillTitle:i.message,prefillStack:i.stack,onClose:c})):null)}function Jt(){const e=De?.getAttribute("data-project")||"default",t=De?.getAttribute("data-pin")||"",n=De?.src.replace("/widget.js","")||"",o=Xt(n,t),i=document.createElement("div");i.id="devtools-widget",document.body.appendChild(i);const r=i.attachShadow({mode:"open"}),l=document.createElement("style");l.textContent=Is,r.appendChild(l);const c=document.createElement("div");c.id="devtools-root",r.appendChild(c),on(s(Ps,{projectId:e,pinHash:t,apiBase:n,apiClient:o}),c),ps(e,t,n)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Jt):Jt()})();
