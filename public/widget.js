(function(){"use strict";var ae,E,je,U,Ue,qe,Xe,Ye,be,Se,ve,Y={},Ve=[],on=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i,ce=Array.isArray;function F(e,t){for(var n in t)e[n]=t[n];return e}function we(e){e&&e.parentNode&&e.parentNode.removeChild(e)}function r(e,t,n){var o,a,s,l={};for(s in t)s=="key"?o=t[s]:s=="ref"?a=t[s]:l[s]=t[s];if(arguments.length>2&&(l.children=arguments.length>3?ae.call(arguments,2):n),typeof e=="function"&&e.defaultProps!=null)for(s in e.defaultProps)l[s]===void 0&&(l[s]=e.defaultProps[s]);return de(e,l,o,a,null)}function de(e,t,n,o,a){var s={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__c:null,constructor:void 0,__v:a??++je,__i:-1,__u:0};return a==null&&E.vnode!=null&&E.vnode(s),s}function ue(e){return e.children}function pe(e,t){this.props=e,this.context=t}function X(e,t){if(t==null)return e.__?X(e.__,e.__i+1):null;for(var n;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null)return n.__e;return typeof e.type=="function"?X(e):null}function Ge(e){var t,n;if((e=e.__)!=null&&e.__c!=null){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if((n=e.__k[t])!=null&&n.__e!=null){e.__e=e.__c.base=n.__e;break}return Ge(e)}}function Je(e){(!e.__d&&(e.__d=!0)&&U.push(e)&&!fe.__r++||Ue!=E.debounceRendering)&&((Ue=E.debounceRendering)||qe)(fe)}function fe(){for(var e,t,n,o,a,s,l,c=1;U.length;)U.length>c&&U.sort(Xe),e=U.shift(),c=U.length,e.__d&&(n=void 0,o=void 0,a=(o=(t=e).__v).__e,s=[],l=[],t.__P&&((n=F({},o)).__v=o.__v+1,E.vnode&&E.vnode(n),ke(t.__P,n,o,t.__n,t.__P.namespaceURI,32&o.__u?[a]:null,s,a??X(o),!!(32&o.__u),l),n.__v=o.__v,n.__.__k[n.__i]=n,tt(s,n,l),o.__e=o.__=null,n.__e!=a&&Ge(n)));fe.__r=0}function Ke(e,t,n,o,a,s,l,c,g,d,f){var i,p,h,x,k,b,_,v=o&&o.__k||Ve,$=t.length;for(g=rn(n,t,v,g,$),i=0;i<$;i++)(h=n.__k[i])!=null&&(p=h.__i==-1?Y:v[h.__i]||Y,h.__i=i,b=ke(e,h,p,a,s,l,c,g,d,f),x=h.__e,h.ref&&p.ref!=h.ref&&(p.ref&&$e(p.ref,null,h),f.push(h.ref,h.__c||x,h)),k==null&&x!=null&&(k=x),(_=!!(4&h.__u))||p.__k===h.__k?g=Ze(h,g,e,_):typeof h.type=="function"&&b!==void 0?g=b:x&&(g=x.nextSibling),h.__u&=-7);return n.__e=k,g}function rn(e,t,n,o,a){var s,l,c,g,d,f=n.length,i=f,p=0;for(e.__k=new Array(a),s=0;s<a;s++)(l=t[s])!=null&&typeof l!="boolean"&&typeof l!="function"?(typeof l=="string"||typeof l=="number"||typeof l=="bigint"||l.constructor==String?l=e.__k[s]=de(null,l,null,null,null):ce(l)?l=e.__k[s]=de(ue,{children:l},null,null,null):l.constructor===void 0&&l.__b>0?l=e.__k[s]=de(l.type,l.props,l.key,l.ref?l.ref:null,l.__v):e.__k[s]=l,g=s+p,l.__=e,l.__b=e.__b+1,c=null,(d=l.__i=sn(l,n,g,i))!=-1&&(i--,(c=n[d])&&(c.__u|=2)),c==null||c.__v==null?(d==-1&&(a>f?p--:a<f&&p++),typeof l.type!="function"&&(l.__u|=4)):d!=g&&(d==g-1?p--:d==g+1?p++:(d>g?p--:p++,l.__u|=4))):e.__k[s]=null;if(i)for(s=0;s<f;s++)(c=n[s])!=null&&(2&c.__u)==0&&(c.__e==o&&(o=X(c)),ot(c,c));return o}function Ze(e,t,n,o){var a,s;if(typeof e.type=="function"){for(a=e.__k,s=0;a&&s<a.length;s++)a[s]&&(a[s].__=e,t=Ze(a[s],t,n,o));return t}e.__e!=t&&(o&&(t&&e.type&&!t.parentNode&&(t=X(e)),n.insertBefore(e.__e,t||null)),t=e.__e);do t=t&&t.nextSibling;while(t!=null&&t.nodeType==8);return t}function sn(e,t,n,o){var a,s,l,c=e.key,g=e.type,d=t[n],f=d!=null&&(2&d.__u)==0;if(d===null&&c==null||f&&c==d.key&&g==d.type)return n;if(o>(f?1:0)){for(a=n-1,s=n+1;a>=0||s<t.length;)if((d=t[l=a>=0?a--:s++])!=null&&(2&d.__u)==0&&c==d.key&&g==d.type)return l}return-1}function Qe(e,t,n){t[0]=="-"?e.setProperty(t,n??""):e[t]=n==null?"":typeof n!="number"||on.test(t)?n:n+"px"}function ge(e,t,n,o,a){var s,l;e:if(t=="style")if(typeof n=="string")e.style.cssText=n;else{if(typeof o=="string"&&(e.style.cssText=o=""),o)for(t in o)n&&t in n||Qe(e.style,t,"");if(n)for(t in n)o&&n[t]==o[t]||Qe(e.style,t,n[t])}else if(t[0]=="o"&&t[1]=="n")s=t!=(t=t.replace(Ye,"$1")),l=t.toLowerCase(),t=l in e||t=="onFocusOut"||t=="onFocusIn"?l.slice(2):t.slice(2),e.l||(e.l={}),e.l[t+s]=n,n?o?n.u=o.u:(n.u=be,e.addEventListener(t,s?ve:Se,s)):e.removeEventListener(t,s?ve:Se,s);else{if(a=="http://www.w3.org/2000/svg")t=t.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(t!="width"&&t!="height"&&t!="href"&&t!="list"&&t!="form"&&t!="tabIndex"&&t!="download"&&t!="rowSpan"&&t!="colSpan"&&t!="role"&&t!="popover"&&t in e)try{e[t]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&t[4]!="-"?e.removeAttribute(t):e.setAttribute(t,t=="popover"&&n==1?"":n))}}function et(e){return function(t){if(this.l){var n=this.l[t.type+e];if(t.t==null)t.t=be++;else if(t.t<n.u)return;return n(E.event?E.event(t):t)}}}function ke(e,t,n,o,a,s,l,c,g,d){var f,i,p,h,x,k,b,_,v,$,C,D,z,j,P,L,H,S=t.type;if(t.constructor!==void 0)return null;128&n.__u&&(g=!!(32&n.__u),s=[c=t.__e=n.__e]),(f=E.__b)&&f(t);e:if(typeof S=="function")try{if(_=t.props,v="prototype"in S&&S.prototype.render,$=(f=S.contextType)&&o[f.__c],C=f?$?$.props.value:f.__:o,n.__c?b=(i=t.__c=n.__c).__=i.__E:(v?t.__c=i=new S(_,C):(t.__c=i=new pe(_,C),i.constructor=S,i.render=an),$&&$.sub(i),i.state||(i.state={}),i.__n=o,p=i.__d=!0,i.__h=[],i._sb=[]),v&&i.__s==null&&(i.__s=i.state),v&&S.getDerivedStateFromProps!=null&&(i.__s==i.state&&(i.__s=F({},i.__s)),F(i.__s,S.getDerivedStateFromProps(_,i.__s))),h=i.props,x=i.state,i.__v=t,p)v&&S.getDerivedStateFromProps==null&&i.componentWillMount!=null&&i.componentWillMount(),v&&i.componentDidMount!=null&&i.__h.push(i.componentDidMount);else{if(v&&S.getDerivedStateFromProps==null&&_!==h&&i.componentWillReceiveProps!=null&&i.componentWillReceiveProps(_,C),t.__v==n.__v||!i.__e&&i.shouldComponentUpdate!=null&&i.shouldComponentUpdate(_,i.__s,C)===!1){for(t.__v!=n.__v&&(i.props=_,i.state=i.__s,i.__d=!1),t.__e=n.__e,t.__k=n.__k,t.__k.some(function(B){B&&(B.__=t)}),D=0;D<i._sb.length;D++)i.__h.push(i._sb[D]);i._sb=[],i.__h.length&&l.push(i);break e}i.componentWillUpdate!=null&&i.componentWillUpdate(_,i.__s,C),v&&i.componentDidUpdate!=null&&i.__h.push(function(){i.componentDidUpdate(h,x,k)})}if(i.context=C,i.props=_,i.__P=e,i.__e=!1,z=E.__r,j=0,v){for(i.state=i.__s,i.__d=!1,z&&z(t),f=i.render(i.props,i.state,i.context),P=0;P<i._sb.length;P++)i.__h.push(i._sb[P]);i._sb=[]}else do i.__d=!1,z&&z(t),f=i.render(i.props,i.state,i.context),i.state=i.__s;while(i.__d&&++j<25);i.state=i.__s,i.getChildContext!=null&&(o=F(F({},o),i.getChildContext())),v&&!p&&i.getSnapshotBeforeUpdate!=null&&(k=i.getSnapshotBeforeUpdate(h,x)),L=f,f!=null&&f.type===ue&&f.key==null&&(L=nt(f.props.children)),c=Ke(e,ce(L)?L:[L],t,n,o,a,s,l,c,g,d),i.base=t.__e,t.__u&=-161,i.__h.length&&l.push(i),b&&(i.__E=i.__=null)}catch(B){if(t.__v=null,g||s!=null)if(B.then){for(t.__u|=g?160:128;c&&c.nodeType==8&&c.nextSibling;)c=c.nextSibling;s[s.indexOf(c)]=null,t.__e=c}else{for(H=s.length;H--;)we(s[H]);Ce(t)}else t.__e=n.__e,t.__k=n.__k,B.then||Ce(t);E.__e(B,t,n)}else s==null&&t.__v==n.__v?(t.__k=n.__k,t.__e=n.__e):c=t.__e=ln(n.__e,t,n,o,a,s,l,g,d);return(f=E.diffed)&&f(t),128&t.__u?void 0:c}function Ce(e){e&&e.__c&&(e.__c.__e=!0),e&&e.__k&&e.__k.forEach(Ce)}function tt(e,t,n){for(var o=0;o<n.length;o++)$e(n[o],n[++o],n[++o]);E.__c&&E.__c(t,e),e.some(function(a){try{e=a.__h,a.__h=[],e.some(function(s){s.call(a)})}catch(s){E.__e(s,a.__v)}})}function nt(e){return typeof e!="object"||e==null||e.__b&&e.__b>0?e:ce(e)?e.map(nt):F({},e)}function ln(e,t,n,o,a,s,l,c,g){var d,f,i,p,h,x,k,b=n.props||Y,_=t.props,v=t.type;if(v=="svg"?a="http://www.w3.org/2000/svg":v=="math"?a="http://www.w3.org/1998/Math/MathML":a||(a="http://www.w3.org/1999/xhtml"),s!=null){for(d=0;d<s.length;d++)if((h=s[d])&&"setAttribute"in h==!!v&&(v?h.localName==v:h.nodeType==3)){e=h,s[d]=null;break}}if(e==null){if(v==null)return document.createTextNode(_);e=document.createElementNS(a,v,_.is&&_),c&&(E.__m&&E.__m(t,s),c=!1),s=null}if(v==null)b===_||c&&e.data==_||(e.data=_);else{if(s=s&&ae.call(e.childNodes),!c&&s!=null)for(b={},d=0;d<e.attributes.length;d++)b[(h=e.attributes[d]).name]=h.value;for(d in b)if(h=b[d],d!="children"){if(d=="dangerouslySetInnerHTML")i=h;else if(!(d in _)){if(d=="value"&&"defaultValue"in _||d=="checked"&&"defaultChecked"in _)continue;ge(e,d,null,h,a)}}for(d in _)h=_[d],d=="children"?p=h:d=="dangerouslySetInnerHTML"?f=h:d=="value"?x=h:d=="checked"?k=h:c&&typeof h!="function"||b[d]===h||ge(e,d,h,b[d],a);if(f)c||i&&(f.__html==i.__html||f.__html==e.innerHTML)||(e.innerHTML=f.__html),t.__k=[];else if(i&&(e.innerHTML=""),Ke(t.type=="template"?e.content:e,ce(p)?p:[p],t,n,o,v=="foreignObject"?"http://www.w3.org/1999/xhtml":a,s,l,s?s[0]:n.__k&&X(n,0),c,g),s!=null)for(d=s.length;d--;)we(s[d]);c||(d="value",v=="progress"&&x==null?e.removeAttribute("value"):x!=null&&(x!==e[d]||v=="progress"&&!x||v=="option"&&x!=b[d])&&ge(e,d,x,b[d],a),d="checked",k!=null&&k!=e[d]&&ge(e,d,k,b[d],a))}return e}function $e(e,t,n){try{if(typeof e=="function"){var o=typeof e.__u=="function";o&&e.__u(),o&&t==null||(e.__u=e(t))}else e.current=t}catch(a){E.__e(a,n)}}function ot(e,t,n){var o,a;if(E.unmount&&E.unmount(e),(o=e.ref)&&(o.current&&o.current!=e.__e||$e(o,null,t)),(o=e.__c)!=null){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(s){E.__e(s,t)}o.base=o.__P=null}if(o=e.__k)for(a=0;a<o.length;a++)o[a]&&ot(o[a],t,n||typeof e.type!="function");n||we(e.__e),e.__c=e.__=e.__e=void 0}function an(e,t,n){return this.constructor(e,n)}function cn(e,t,n){var o,a,s,l;t==document&&(t=document.documentElement),E.__&&E.__(e,t),a=(o=!1)?null:t.__k,s=[],l=[],ke(t,e=t.__k=r(ue,null,[e]),a||Y,Y,t.namespaceURI,a?null:t.firstChild?ae.call(t.childNodes):null,s,a?a.__e:t.firstChild,o,l),tt(s,e,l)}ae=Ve.slice,E={__e:function(e,t,n,o){for(var a,s,l;t=t.__;)if((a=t.__c)&&!a.__)try{if((s=a.constructor)&&s.getDerivedStateFromError!=null&&(a.setState(s.getDerivedStateFromError(e)),l=a.__d),a.componentDidCatch!=null&&(a.componentDidCatch(e,o||{}),l=a.__d),l)return a.__E=a}catch(c){e=c}throw e}},je=0,pe.prototype.setState=function(e,t){var n;n=this.__s!=null&&this.__s!=this.state?this.__s:this.__s=F({},this.state),typeof e=="function"&&(e=e(F({},n),this.props)),e&&F(n,e),e!=null&&this.__v&&(t&&this._sb.push(t),Je(this))},pe.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),Je(this))},pe.prototype.render=ue,U=[],qe=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,Xe=function(e,t){return e.__v.__b-t.__v.__b},fe.__r=0,Ye=/(PointerCapture)$|Capture$/i,be=0,Se=et(!1),ve=et(!0);var V,R,Ee,rt,G=0,st=[],M=E,it=M.__b,lt=M.__r,at=M.diffed,ct=M.__c,dt=M.unmount,ut=M.__;function Be(e,t){M.__h&&M.__h(R,e,G||t),G=0;var n=R.__H||(R.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function y(e){return G=1,dn(ht,e)}function dn(e,t,n){var o=Be(V++,2);if(o.t=e,!o.__c&&(o.__=[ht(void 0,t),function(c){var g=o.__N?o.__N[0]:o.__[0],d=o.t(g,c);g!==d&&(o.__N=[d,o.__[1]],o.__c.setState({}))}],o.__c=R,!R.__f)){var a=function(c,g,d){if(!o.__c.__H)return!0;var f=o.__c.__H.__.filter(function(p){return!!p.__c});if(f.every(function(p){return!p.__N}))return!s||s.call(this,c,g,d);var i=o.__c.props!==c;return f.forEach(function(p){if(p.__N){var h=p.__[0];p.__=p.__N,p.__N=void 0,h!==p.__[0]&&(i=!0)}}),s&&s.call(this,c,g,d)||i};R.__f=!0;var s=R.shouldComponentUpdate,l=R.componentWillUpdate;R.componentWillUpdate=function(c,g,d){if(this.__e){var f=s;s=void 0,a(c,g,d),s=f}l&&l.call(this,c,g,d)},R.shouldComponentUpdate=a}return o.__N||o.__}function W(e,t){var n=Be(V++,3);!M.__s&&gt(n.__H,t)&&(n.__=e,n.u=t,R.__H.__h.push(n))}function q(e){return G=5,pt(function(){return{current:e}},[])}function pt(e,t){var n=Be(V++,7);return gt(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function w(e,t){return G=8,pt(function(){return e},t)}function un(){for(var e;e=st.shift();)if(e.__P&&e.__H)try{e.__H.__h.forEach(he),e.__H.__h.forEach(Te),e.__H.__h=[]}catch(t){e.__H.__h=[],M.__e(t,e.__v)}}M.__b=function(e){R=null,it&&it(e)},M.__=function(e,t){e&&t.__k&&t.__k.__m&&(e.__m=t.__k.__m),ut&&ut(e,t)},M.__r=function(e){lt&&lt(e),V=0;var t=(R=e.__c).__H;t&&(Ee===R?(t.__h=[],R.__h=[],t.__.forEach(function(n){n.__N&&(n.__=n.__N),n.u=n.__N=void 0})):(t.__h.forEach(he),t.__h.forEach(Te),t.__h=[],V=0)),Ee=R},M.diffed=function(e){at&&at(e);var t=e.__c;t&&t.__H&&(t.__H.__h.length&&(st.push(t)!==1&&rt===M.requestAnimationFrame||((rt=M.requestAnimationFrame)||pn)(un)),t.__H.__.forEach(function(n){n.u&&(n.__H=n.u),n.u=void 0})),Ee=R=null},M.__c=function(e,t){t.some(function(n){try{n.__h.forEach(he),n.__h=n.__h.filter(function(o){return!o.__||Te(o)})}catch(o){t.some(function(a){a.__h&&(a.__h=[])}),t=[],M.__e(o,n.__v)}}),ct&&ct(e,t)},M.unmount=function(e){dt&&dt(e);var t,n=e.__c;n&&n.__H&&(n.__H.__.forEach(function(o){try{he(o)}catch(a){t=a}}),n.__H=void 0,t&&M.__e(t,n.__v))};var ft=typeof requestAnimationFrame=="function";function pn(e){var t,n=function(){clearTimeout(o),ft&&cancelAnimationFrame(t),setTimeout(e)},o=setTimeout(n,35);ft&&(t=requestAnimationFrame(n))}function he(e){var t=R,n=e.__c;typeof n=="function"&&(e.__c=void 0,n()),R=t}function Te(e){var t=R;e.__c=e.__(),R=t}function gt(e,t){return!e||e.length!==t.length||t.some(function(n,o){return n!==e[o]})}function ht(e,t){return typeof t=="function"?t(e):t}const u={fabBg:"#3b82f6",fabBgHover:"#2563eb",panelBg:"#0f172a",panelBorder:"#1e293b",panelHeaderBg:"#1e293b",toolBtnBg:"#1e293b",toolBtnBgHover:"#334155",toolBtnBgActive:"#3b82f6",text:"#e2e8f0",textMuted:"#94a3b8",textBright:"#f8fafc",closeBtnHover:"#ef4444",shadow:"rgba(0, 0, 0, 0.4)"},xt=48,Re=300,fn=5,gn={position:"fixed",width:`${xt}px`,height:`${xt}px`,borderRadius:"50%",backgroundColor:u.fabBg,color:"#fff",border:"none",cursor:"grab",fontSize:"20px",display:"flex",alignItems:"center",justifyContent:"center",zIndex:999999,boxShadow:`0 4px 12px ${u.shadow}`,transition:"background-color 0.15s ease, box-shadow 0.15s ease",touchAction:"none",userSelect:"none",WebkitUserSelect:"none"},hn={position:"fixed",width:`${Re}px`,backgroundColor:u.panelBg,border:`1px solid ${u.panelBorder}`,borderRadius:"8px",zIndex:999998,display:"flex",flexDirection:"column",fontFamily:"system-ui, -apple-system, sans-serif",color:u.text,boxShadow:`0 8px 32px ${u.shadow}`,overflow:"hidden"},xn={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 16px",backgroundColor:u.panelHeaderBg,borderBottom:`1px solid ${u.panelBorder}`,flexShrink:"0"},_n={fontSize:"14px",fontWeight:"600",color:u.textBright,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"220px"},mn={width:"28px",height:"28px",borderRadius:"6px",border:"none",backgroundColor:"transparent",color:u.textMuted,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"18px",lineHeight:"1",flexShrink:"0"},yn={display:"flex",flexDirection:"column",gap:"4px",padding:"12px",overflowY:"auto",flex:"1"},bn={display:"flex",alignItems:"center",gap:"10px",padding:"10px 12px",borderRadius:"8px",border:"none",backgroundColor:u.toolBtnBg,color:u.text,cursor:"pointer",fontSize:"13px",fontWeight:"500",textAlign:"left",transition:"background-color 0.12s ease",width:"100%"},Sn={width:"20px",height:"20px",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",flexShrink:"0"},vn={flex:"1",padding:"16px",overflowY:"auto",fontSize:"13px",color:u.textMuted,display:"flex",alignItems:"center",justifyContent:"center"},wn=500;let kn=1;const J=[],K=[];function Cn(){const e=new WeakSet;return(t,n)=>{if(typeof n=="object"&&n!==null){if(e.has(n))return"[Circular]";e.add(n)}return n}}function $n(e){if(e===null)return"null";if(e===void 0)return"undefined";if(typeof e=="string")return e;if(typeof e=="number"||typeof e=="boolean")return String(e);if(e instanceof Error)return`${e.name}: ${e.message}`;try{return JSON.stringify(e,Cn(),2)}catch{return String(e)}}function En(e,t){const n={id:kn++,level:e,args:t.map($n),timestamp:Date.now()};J.length>=wn&&J.shift(),J.push(n);for(const o of K)o()}function Z(){return[...J]}function Bn(){J.length=0;for(const e of K)e()}function _t(e){return K.push(e),()=>{const t=K.indexOf(e);t!==-1&&K.splice(t,1)}}function Tn(){const e=["log","warn","error","info"];for(const t of e){const n=console[t].bind(console);console[t]=(...o)=>{En(t,o),n(...o)}}}const mt={log:"#94a3b8",info:"#3b82f6",warn:"#eab308",error:"#ef4444"},Rn={log:"rgba(148, 163, 184, 0.15)",info:"rgba(59, 130, 246, 0.15)",warn:"rgba(234, 179, 8, 0.15)",error:"rgba(239, 68, 68, 0.15)"},yt=["log","info","warn","error"];function Mn(e){const t=new Date(e),n=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),a=String(t.getSeconds()).padStart(2,"0"),s=String(t.getMilliseconds()).padStart(3,"0");return`${n}:${o}:${a}.${s}`}const zn={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden"},Dn={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",gap:"6px",flexShrink:"0"},Hn={display:"flex",gap:"4px",flexWrap:"wrap"},Ln={padding:"3px 8px",borderRadius:"4px",border:"none",backgroundColor:u.toolBtnBg,color:u.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",flexShrink:"0"},Pn={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"0 4px 4px"},In={display:"flex",flexDirection:"column",gap:"2px",padding:"4px 6px",borderRadius:"4px",marginBottom:"2px",fontSize:"11px",fontFamily:"monospace",wordBreak:"break-all"},An={display:"flex",alignItems:"center",gap:"6px"},On={padding:"1px 5px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px",flexShrink:"0"},Nn={fontSize:"10px",color:u.textMuted,flexShrink:"0"},Fn={color:u.text,whiteSpace:"pre-wrap",lineHeight:"1.4"},Wn={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:u.textMuted,fontSize:"12px"};function jn(e,t){return{padding:"2px 6px",borderRadius:"3px",border:"none",backgroundColor:e?mt[t]:u.toolBtnBg,color:e?"#fff":u.textMuted,cursor:"pointer",fontSize:"10px",fontWeight:"600",textTransform:"uppercase"}}function Un(){const[e,t]=y(Z),[n,o]=y(new Set(yt));W(()=>_t(()=>{t(Z())}),[]);const a=w(()=>{Bn(),t([])},[]),s=w(c=>{o(g=>{const d=new Set(g);return d.has(c)?d.delete(c):d.add(c),d})},[]),l=e.filter(c=>n.has(c.level));return r("div",{style:zn},r("div",{style:Dn},r("div",{style:Hn},yt.map(c=>r("button",{key:c,style:jn(n.has(c),c),onClick:()=>s(c),title:`Toggle ${c} entries`},c))),r("button",{style:Ln,onClick:a,title:"Clear console entries"},"Clear")),l.length===0?r("div",{style:Wn},"No console entries"):r("div",{style:Pn},l.map(c=>r("div",{key:c.id,style:{...In,backgroundColor:Rn[c.level]}},r("div",{style:An},r("span",{style:{...On,backgroundColor:mt[c.level],color:"#fff"}},c.level),r("span",{style:Nn},Mn(c.timestamp))),r("div",{style:Fn},c.args.join(" "))))))}const qn=200;let Me=1;const Q=[],ee=[];function Xn(e){if(!e.response)return 0;if(typeof e.response=="string")return e.response.length;if(e.response instanceof Blob)return e.response.size;if(e.response instanceof ArrayBuffer)return e.response.byteLength;try{return JSON.stringify(e.response).length}catch{return 0}}function bt(e){if(e==null)return 0;if(typeof e=="string")return e.length;if(e instanceof Blob)return e.size;if(e instanceof ArrayBuffer)return e.byteLength;if(e instanceof FormData){let t=0;return e.forEach(n=>{typeof n=="string"?t+=n.length:n instanceof Blob&&(t+=n.size)}),t}return e instanceof URLSearchParams?e.toString().length:0}function St(e){const t={};return e.forEach((n,o)=>{t[o]=n}),t}function ze(e){Q.length>=qn&&Q.shift(),Q.push(e);for(const t of ee)t()}function te(){return[...Q]}function Yn(){Q.length=0;for(const e of ee)e()}function vt(e){return ee.push(e),()=>{const t=ee.indexOf(e);t!==-1&&ee.splice(t,1)}}function Vn(){const e=XMLHttpRequest.prototype,t=e.open,n=e.setRequestHeader,o=e.send,a=new WeakMap;e.open=function(s,l,...c){return a.set(this,{method:s.toUpperCase(),url:typeof l=="string"?l:String(l),requestHeaders:{},requestSize:0,startTime:0,timestamp:0}),t.call(this,s,l,...c)},e.setRequestHeader=function(s,l){const c=a.get(this);return c&&(c.requestHeaders[s]=l),n.call(this,s,l)},e.send=function(s){const l=a.get(this);return l&&(l.requestSize=bt(s??null),l.startTime=performance.now(),l.timestamp=Date.now(),this.addEventListener("loadend",()=>{const c=performance.now()-l.startTime,g={},d=this.getAllResponseHeaders();for(const i of d.trim().split(`\r
`)){const p=i.indexOf(": ");p!==-1&&(g[i.slice(0,p).toLowerCase()]=i.slice(p+2))}const f={id:Me++,method:l.method,url:l.url,status:this.status,statusText:this.statusText||(this.status===0?"Network Error":""),duration:Math.round(c),requestSize:l.requestSize,responseSize:Xn(this),requestHeaders:l.requestHeaders,responseHeaders:g,startTime:l.startTime,timestamp:l.timestamp};ze(f),a.delete(this)})),o.call(this,s)}}function Gn(){const e=window.fetch.bind(window);window.fetch=async(t,n)=>{const o=(n?.method??"GET").toUpperCase(),a=typeof t=="string"?t:t instanceof URL?t.href:t.url,s=bt(n?.body??null);let l={};if(n?.headers)if(n.headers instanceof Headers)l=St(n.headers);else if(Array.isArray(n.headers))for(const[d,f]of n.headers)l[d]=f;else l={...n.headers};const c=performance.now(),g=Date.now();try{const d=await e(t,n),f=performance.now()-c,i=d.clone();let p=0;try{p=(await i.blob()).size}catch{p=0}const h={id:Me++,method:o,url:a,status:d.status,statusText:d.statusText,duration:Math.round(f),requestSize:s,responseSize:p,requestHeaders:l,responseHeaders:St(d.headers),startTime:c,timestamp:g};return ze(h),d}catch(d){const f=performance.now()-c,i={id:Me++,method:o,url:a,status:0,statusText:"Network Error",duration:Math.round(f),requestSize:s,responseSize:0,requestHeaders:l,responseHeaders:{},startTime:c,timestamp:g};throw ze(i),d}},Vn()}const Jn={GET:"#22c55e",POST:"#3b82f6",PUT:"#eab308",DELETE:"#ef4444",PATCH:"#a855f7"},Kn="#94a3b8";function Zn(e){return Jn[e]??Kn}function Qn(e){return e===0?"#ef4444":e<300?"#22c55e":e<400?"#3b82f6":e<500?"#eab308":"#ef4444"}function wt(e){return e===0?"rgba(239, 68, 68, 0.15)":e<300?"rgba(34, 197, 94, 0.15)":e<400?"rgba(59, 130, 246, 0.15)":e<500?"rgba(234, 179, 8, 0.15)":"rgba(239, 68, 68, 0.15)"}function kt(e){const t=new Date(e),n=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),a=String(t.getSeconds()).padStart(2,"0"),s=String(t.getMilliseconds()).padStart(3,"0");return`${n}:${o}:${a}.${s}`}function Ct(e){return e<1e3?`${e}ms`:`${(e/1e3).toFixed(1)}s`}function $t(e){return e===0?"0 B":e<1024?`${e} B`:e<1024*1024?`${(e/1024).toFixed(1)} KB`:`${(e/(1024*1024)).toFixed(1)} MB`}function eo(e,t){return e.length<=t?e:e.slice(0,t-3)+"..."}const to={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden"},no={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",gap:"6px",flexShrink:"0"},oo={fontSize:"10px",color:u.textMuted,flexShrink:"0"},ro={padding:"3px 8px",borderRadius:"4px",border:"none",backgroundColor:u.toolBtnBg,color:u.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",flexShrink:"0"},so={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"0 4px 4px"},io={display:"flex",flexDirection:"column",padding:"5px 6px",borderRadius:"4px",marginBottom:"2px",fontSize:"11px",fontFamily:"monospace",cursor:"pointer",transition:"background-color 0.1s ease"},lo={display:"flex",alignItems:"center",gap:"6px",minWidth:"0"},ao={padding:"1px 5px",borderRadius:"3px",fontSize:"9px",fontWeight:"700",textTransform:"uppercase",letterSpacing:"0.5px",flexShrink:"0",color:"#fff"},co={padding:"1px 4px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",flexShrink:"0"},uo={flex:"1",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:u.text,fontSize:"10px",minWidth:"0"},po={fontSize:"10px",color:u.textMuted,flexShrink:"0",textAlign:"right",minWidth:"40px"},fo={fontSize:"10px",color:u.textMuted,flexShrink:"0"},go={marginTop:"6px",padding:"6px 8px",borderRadius:"4px",backgroundColor:"rgba(0, 0, 0, 0.25)",fontSize:"10px",fontFamily:"monospace",lineHeight:"1.5",wordBreak:"break-all"},De={fontWeight:"600",color:u.textBright,marginBottom:"2px",marginTop:"6px",display:"block"},ho={color:u.textMuted},Et={display:"flex",gap:"4px",color:u.textMuted,padding:"1px 0"},Bt={color:"#93c5fd",flexShrink:"0"},xo={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:u.textMuted,fontSize:"12px"};function _o({entry:e}){const t=Object.entries(e.requestHeaders),n=Object.entries(e.responseHeaders);return r("div",{style:go},r("span",{style:{...De,marginTop:"0"}},"General"),r("div",{style:ho},r("div",null,`URL: ${e.url}`),r("div",null,`Method: ${e.method}`),r("div",null,`Status: ${e.status} ${e.statusText}`),r("div",null,`Duration: ${Ct(e.duration)}`),r("div",null,`Request size: ${$t(e.requestSize)}`),r("div",null,`Response size: ${$t(e.responseSize)}`),r("div",null,`Time: ${kt(e.timestamp)}`)),t.length>0?r("div",null,r("span",{style:De},"Request Headers"),t.map(([o,a])=>r("div",{key:o,style:Et},r("span",{style:Bt},`${o}:`),r("span",null,a)))):null,n.length>0?r("div",null,r("span",{style:De},"Response Headers"),n.map(([o,a])=>r("div",{key:o,style:Et},r("span",{style:Bt},`${o}:`),r("span",null,a)))):null)}function mo(){const[e,t]=y(te),[n,o]=y(null);W(()=>vt(()=>{t(te())}),[]);const a=w(()=>{Yn(),t([]),o(null)},[]),s=w(l=>{o(c=>c===l?null:l)},[]);return r("div",{style:to},r("div",{style:no},r("span",{style:oo},`${e.length} request${e.length!==1?"s":""}`),r("button",{style:ro,onClick:a,title:"Clear network entries"},"Clear")),e.length===0?r("div",{style:xo},"No network requests"):r("div",{style:so},e.map(l=>{const c=n===l.id;return r("div",{key:l.id,style:{...io,backgroundColor:c?"rgba(59, 130, 246, 0.12)":wt(l.status)},onClick:()=>s(l.id)},r("div",{style:lo},r("span",{style:{...ao,backgroundColor:Zn(l.method)}},l.method),r("span",{style:{...co,color:Qn(l.status),backgroundColor:wt(l.status)}},l.status===0?"ERR":String(l.status)),r("span",{style:uo,title:l.url},eo(l.url,40)),r("span",{style:po},Ct(l.duration)),r("span",{style:fo},kt(l.timestamp))),c?r(_o,{entry:l}):null)})))}const yo=100;let Tt=1;const ne=[],oe=[];let He=null;function Rt(e){He=e}function Mt(e){ne.length>=yo&&ne.shift(),ne.push(e);for(const t of oe)t();He&&He(e)}function re(){return[...ne]}function bo(){ne.length=0;for(const e of oe)e()}function zt(e){return oe.push(e),()=>{const t=oe.indexOf(e);t!==-1&&oe.splice(t,1)}}function So(){const e=window.onerror;window.onerror=(t,n,o,a,s)=>{const l={id:Tt++,message:typeof t=="string"?t:"Unknown error",stack:s?.stack??"",source:n??"",line:o??0,col:a??0,timestamp:Date.now(),type:"error"};return Mt(l),typeof e=="function"?e(t,n,o,a,s):!1},window.addEventListener("unhandledrejection",t=>{const n=t.reason,o=n instanceof Error,a=o?n.message:typeof n=="string"?n:"Unhandled promise rejection",s=o?n.stack??"":"",l={id:Tt++,message:a,stack:s,source:"",line:0,col:0,timestamp:Date.now(),type:"unhandledrejection"};Mt(l)})}const vo="#ef4444",wo="rgba(239, 68, 68, 0.15)",ko="#f97316",Co="rgba(249, 115, 22, 0.15)",$o={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden"},Eo={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",gap:"6px",flexShrink:"0"},Bo={fontSize:"10px",color:u.textMuted,flexShrink:"0"},To={padding:"3px 8px",borderRadius:"4px",border:"none",backgroundColor:u.toolBtnBg,color:u.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",flexShrink:"0"},Ro={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"0 4px 4px"},Mo={display:"flex",flexDirection:"column",gap:"2px",padding:"4px 6px",borderRadius:"4px",marginBottom:"2px",fontSize:"11px",fontFamily:"monospace",wordBreak:"break-all",cursor:"pointer"},zo={display:"flex",alignItems:"center",gap:"6px"},Do={padding:"1px 5px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.5px",flexShrink:"0",color:"#fff"},Ho={fontSize:"10px",color:u.textMuted,flexShrink:"0"},Dt={padding:"1px 0",wordBreak:"break-all"},Lo={...Dt,opacity:"0.5"},Po={padding:"3px 8px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"11px",fontWeight:"500",backgroundColor:"#dc2626",color:"#fff"},Io={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:u.textMuted,fontSize:"12px"};function Ao(e){const t=new Date(e),n=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),a=String(t.getSeconds()).padStart(2,"0"),s=String(t.getMilliseconds()).padStart(3,"0");return`${n}:${o}:${a}.${s}`}function Oo(e){return e==="error"?vo:ko}function No(e){return e==="error"?wo:Co}function Fo(e){return e?e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0):[]}function Wo(e){return e.includes("node_modules")}function jo({onReportBug:e}){const[t,n]=y(re),[o,a]=y(null);W(()=>zt(()=>{n(re())}),[]);const s=w(()=>{bo(),n([]),a(null)},[]),l=w(c=>{a(g=>g===c?null:c)},[]);return r("div",{style:$o},r("div",{style:Eo},r("span",{style:Bo},`${t.length} error${t.length!==1?"s":""}`),r("button",{style:To,onClick:s,title:"Clear error entries"},"Clear")),t.length===0?r("div",{style:Io},"No errors captured"):r("div",{style:Ro},t.map(c=>{const g=o===c.id,d=Fo(c.stack);return r("div",{key:c.id,style:{...Mo,backgroundColor:g?"rgba(239, 68, 68, 0.12)":No(c.type)},onClick:()=>l(c.id)},r("div",{style:zo},r("span",{style:{...Do,backgroundColor:Oo(c.type)}},c.type==="error"?"ERR":"REJ"),r("span",{style:{flex:"1",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:u.text,fontSize:"10px"}},c.message),r("span",{style:Ho},Ao(c.timestamp))),g?r("div",{style:{marginTop:"6px",padding:"6px 8px",borderRadius:"4px",backgroundColor:"rgba(0, 0, 0, 0.25)",fontSize:"10px",fontFamily:"monospace",lineHeight:"1.5"}},c.source?r("div",{style:{color:"#93c5fd",marginBottom:"4px"}},`${c.source}:${c.line}:${c.col}`):null,d.length>0?d.map((f,i)=>r("div",{key:i,style:Wo(f)?Lo:Dt},f)):r("span",{style:{color:u.textMuted}},"No stack trace available"),e?r("button",{style:{...Po,marginTop:"8px",width:"100%"},onClick:f=>{f.stopPropagation(),e(c)}},"Report Bug"):null):null)})))}const Uo=["low","medium","high","critical"],qo={low:"#22c55e",medium:"#eab308",high:"#f97316",critical:"#ef4444"},Ht={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden",padding:"8px",gap:"8px",boxSizing:"border-box"},xe={fontSize:"11px",fontWeight:"600",color:u.textBright,marginBottom:"3px",display:"block"},Lt={width:"100%",padding:"6px 8px",borderRadius:"4px",border:`1px solid ${u.panelBorder}`,backgroundColor:"rgba(0, 0, 0, 0.3)",color:u.text,fontSize:"12px",fontFamily:"system-ui, -apple-system, sans-serif",outline:"none",boxSizing:"border-box"},Xo={...Lt,minHeight:"60px",resize:"vertical",lineHeight:"1.4"},Yo={display:"flex",gap:"4px"},Vo={padding:"4px 8px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"11px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.3px",flex:"1",textAlign:"center"},Le={padding:"8px 16px",borderRadius:"6px",border:"none",backgroundColor:u.fabBg,color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"600",width:"100%",marginTop:"4px"},Go={...Le,opacity:"0.5",cursor:"not-allowed"},Pt={padding:"8px 12px",borderRadius:"6px",fontSize:"12px",fontWeight:"500",textAlign:"center"},Jo={...Pt,backgroundColor:"rgba(34, 197, 94, 0.15)",color:"#22c55e",border:"1px solid rgba(34, 197, 94, 0.3)"},Ko={...Pt,backgroundColor:"rgba(239, 68, 68, 0.15)",color:"#ef4444",border:"1px solid rgba(239, 68, 68, 0.3)"},Zo={fontSize:"10px",fontFamily:"monospace",color:u.textMuted,backgroundColor:"rgba(0, 0, 0, 0.3)",padding:"6px 8px",borderRadius:"4px",maxHeight:"60px",overflowY:"auto",lineHeight:"1.4",whiteSpace:"pre-wrap",wordBreak:"break-all"},It={padding:"4px 8px",borderRadius:"4px",border:"none",backgroundColor:"rgba(255, 255, 255, 0.1)",color:u.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",alignSelf:"flex-end"};function At({apiClient:e,projectId:t,prefillTitle:n,prefillStack:o,onClose:a}){const[s,l]=y(n??""),[c,g]=y(""),[d,f]=y("medium"),[i,p]=y("idle"),[h,x]=y(""),k=s.trim().length>0&&i!=="submitting",b=w(async()=>{if(k){p("submitting"),x("");try{const _={projectId:t,title:s.trim(),description:c.trim(),severity:d,url:window.location.href,userAgent:navigator.userAgent,timestamp:Date.now()};o&&(_.stackTrace=o),await e.createBug(_),p("success"),l(""),g(""),f("medium")}catch(_){p("error");const v=_ instanceof Error?_.message:"Failed to submit bug report";x(v)}}},[k,s,c,d,t,o,e]);return i==="success"?r("div",{style:Ht},r("div",{style:Jo},"Bug report submitted."),r("button",{style:{...Le,marginTop:"8px"},onClick:()=>p("idle")},"Report Another"),a?r("button",{style:{...It,marginTop:"4px",alignSelf:"center"},onClick:a},"Close"):null):r("div",{style:Ht},a?r("button",{style:It,onClick:a},"Back"):null,r("div",null,r("label",{style:xe},"Title"),r("input",{style:Lt,type:"text",value:s,placeholder:"Describe the bug briefly",onInput:_=>{l(_.target.value)}})),r("div",null,r("label",{style:xe},"Description"),r("textarea",{style:Xo,value:c,placeholder:"Steps to reproduce, expected vs actual behavior",onInput:_=>{g(_.target.value)}})),o?r("div",null,r("label",{style:xe},"Stack Trace"),r("div",{style:Zo},o)):null,r("div",null,r("label",{style:xe},"Severity"),r("div",{style:Yo},Uo.map(_=>r("button",{key:_,style:{...Vo,backgroundColor:d===_?qo[_]:u.toolBtnBg,color:d===_?"#fff":u.textMuted},onClick:()=>f(_)},_)))),i==="error"?r("div",{style:Ko},h||"Submission failed"):null,r("button",{style:k?Le:Go,onClick:b,disabled:!k},i==="submitting"?"Submitting...":"Submit Bug Report"))}const Qo={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden",padding:"8px",gap:"8px",boxSizing:"border-box"},er={display:"flex",gap:"6px",flexShrink:"0"},tr={flex:"1",padding:"6px 8px",borderRadius:"4px",border:`1px solid ${u.panelBorder}`,backgroundColor:"rgba(0, 0, 0, 0.3)",color:u.text,fontSize:"12px",fontFamily:"system-ui, -apple-system, sans-serif",outline:"none",boxSizing:"border-box"},Ot={padding:"6px 10px",borderRadius:"4px",border:"none",backgroundColor:u.fabBg,color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"600",flexShrink:"0"},nr={...Ot,opacity:"0.5",cursor:"not-allowed"},Nt={flex:"1",overflowY:"auto",fontSize:"12px",lineHeight:"1.5",color:u.text,whiteSpace:"pre-wrap",wordBreak:"break-word",backgroundColor:"rgba(0, 0, 0, 0.2)",padding:"8px",borderRadius:"4px",minHeight:"80px"},or={...Nt,color:u.textMuted,display:"flex",alignItems:"center",justifyContent:"center",fontStyle:"italic"},rr={padding:"8px",fontSize:"12px",color:"#ef4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"4px"};function sr({apiBase:e,pinHash:t}){const[n,o]=y(""),[a,s]=y(""),[l,c]=y("idle"),[g,d]=y(""),f=q(null),i=n.trim().length>0&&l!=="loading"&&l!=="streaming",p=w(async()=>{if(!i)return;const x=n.trim();s(""),c("loading"),d(""),f.current&&f.current.abort();const k=new AbortController;f.current=k;try{const b=await fetch(`${e}/api/ai/analyze`,{method:"POST",headers:{"Content-Type":"application/json","X-DevTools-Pin":t},body:JSON.stringify({text:x,context:window.location.href}),signal:k.signal});if(!b.ok)throw new Error(`Request failed (${b.status})`);const _=b.body?.getReader();if(!_)throw new Error("No response stream");c("streaming");const v=new TextDecoder;for(;;){const{done:$,value:C}=await _.read();if($)break;const D=v.decode(C,{stream:!0});D&&s(z=>z+D)}c("idle")}catch(b){if(b.name==="AbortError")return;c("error");const _=b instanceof Error?b.message:"Analysis failed";d(_)}},[i,n,e,t]),h=w(x=>{x.key==="Enter"&&!x.shiftKey&&i&&(x.preventDefault(),p())},[i,p]);return r("div",{style:Qo},r("div",{style:er},r("input",{style:tr,type:"text",value:n,placeholder:"Ask about code, errors, concepts...",onInput:x=>{o(x.target.value)},onKeyDown:h}),r("button",{style:i?Ot:nr,onClick:p,disabled:!i},l==="loading"||l==="streaming"?"...":"Send")),l==="error"?r("div",{style:rr},g):null,a?r("div",{style:Nt},a):r("div",{style:or},l==="loading"?"Thinking...":"Response will appear here"))}const ir=100,lr={LCP:[2500,4e3],CLS:[.1,.25],INP:[200,500],FCP:[1800,3e3],TTFB:[800,1800]};let ar=1;const se=[],_e=[];function cr(e,t){const n=lr[e];return t<=n[0]?"good":t<=n[1]?"needs-improvement":"poor"}function ie(e,t){const n={id:ar++,timestamp:Date.now(),metric:e,value:Math.round(e==="CLS"?t*1e3:t)/(e==="CLS"?1e3:1),rating:cr(e,t)};se.length>=ir&&se.shift(),se.push(n);for(const o of _e)o(n)}function Ft(){return[...se]}function dr(){se.length=0}function Wt(e){return _e.push(e),()=>{const t=_e.indexOf(e);t!==-1&&_e.splice(t,1)}}function ur(){if(!(typeof PerformanceObserver>"u")){try{new PerformanceObserver(t=>{const n=t.getEntries(),o=n[n.length-1];o&&ie("LCP",o.startTime)}).observe({type:"largest-contentful-paint",buffered:!0})}catch{}try{let e=0;new PerformanceObserver(n=>{for(const o of n.getEntries()){const a=o;!a.hadRecentInput&&typeof a.value=="number"&&(e+=a.value,ie("CLS",e))}}).observe({type:"layout-shift",buffered:!0})}catch{}try{new PerformanceObserver(t=>{for(const n of t.getEntries())n.duration>0&&ie("INP",n.duration)}).observe({type:"event",buffered:!0})}catch{}try{new PerformanceObserver(t=>{for(const n of t.getEntries())n.name==="first-contentful-paint"&&ie("FCP",n.startTime)}).observe({type:"paint",buffered:!0})}catch{}try{new PerformanceObserver(t=>{for(const n of t.getEntries()){const o=n;o.responseStart>0&&ie("TTFB",o.responseStart-o.requestStart)}}).observe({type:"navigation",buffered:!0})}catch{}}}const Pe={good:"#22c55e","needs-improvement":"#eab308",poor:"#ef4444"},pr={good:"rgba(34, 197, 94, 0.15)","needs-improvement":"rgba(234, 179, 8, 0.15)",poor:"rgba(239, 68, 68, 0.15)"},fr={LCP:"Largest Contentful Paint",CLS:"Cumulative Layout Shift",INP:"Interaction to Next Paint",FCP:"First Contentful Paint",TTFB:"Time to First Byte"},jt={LCP:"ms",CLS:"",INP:"ms",FCP:"ms",TTFB:"ms"},gr=["LCP","FCP","CLS","INP","TTFB"];function hr(e){const t=new Date(e),n=String(t.getHours()).padStart(2,"0"),o=String(t.getMinutes()).padStart(2,"0"),a=String(t.getSeconds()).padStart(2,"0");return`${n}:${o}:${a}`}function xr(e){const t={};for(const n of e){const o=t[n.metric];(!o||n.id>o.id)&&(t[n.metric]=n)}return t}const _r={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden"},mr={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"6px 8px",flexShrink:"0"},yr={fontSize:"11px",fontWeight:"600",color:u.textBright,textTransform:"uppercase",letterSpacing:"0.5px"},br={padding:"3px 8px",borderRadius:"4px",border:"none",backgroundColor:u.toolBtnBg,color:u.textMuted,cursor:"pointer",fontSize:"11px",fontWeight:"500",flexShrink:"0"},Sr={display:"grid",gridTemplateColumns:"1fr 1fr",gap:"6px",padding:"4px 8px 8px",flexShrink:"0"},vr={display:"flex",flexDirection:"column",alignItems:"center",gap:"2px",padding:"8px 6px",borderRadius:"6px",backgroundColor:u.toolBtnBg},wr={fontSize:"16px",fontWeight:"700",fontFamily:"monospace"},kr={fontSize:"9px",fontWeight:"500",color:u.textMuted,textTransform:"uppercase",letterSpacing:"0.3px"},Cr={height:"1px",backgroundColor:u.panelBorder,margin:"0 8px",flexShrink:"0"},$r={fontSize:"10px",fontWeight:"600",color:u.textMuted,padding:"6px 8px 2px",textTransform:"uppercase",letterSpacing:"0.5px",flexShrink:"0"},Er={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"0 4px 4px"},Br={display:"flex",alignItems:"center",gap:"6px",padding:"4px 6px",borderRadius:"4px",marginBottom:"2px",fontSize:"11px",fontFamily:"monospace"},Tr={padding:"1px 5px",borderRadius:"3px",fontSize:"10px",fontWeight:"600",textTransform:"uppercase",letterSpacing:"0.3px",flexShrink:"0",color:"#fff"},Rr={fontWeight:"600",color:u.text,flexShrink:"0",minWidth:"32px"},Mr={color:u.textBright,flex:"1"},zr={fontSize:"10px",color:u.textMuted,flexShrink:"0"},Dr={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:u.textMuted,fontSize:"12px"};function Hr(e){return e==="good"?"Good":e==="needs-improvement"?"OK":"Poor"}function Lr(){const[e,t]=y(Ft);W(()=>Wt(()=>{t(Ft())}),[]);const n=w(()=>{dr(),t([])},[]),o=xr(e),a=gr.map(s=>{const l=o[s];if(!l)return null;const c=jt[s],g=s==="CLS"?l.value.toFixed(3):`${Math.round(l.value)}`;return{metric:s,entry:l,displayValue:g,unit:c}}).filter(Boolean);return r("div",{style:_r},r("div",{style:mr},r("span",{style:yr},"Web Vitals"),r("button",{style:br,onClick:n,title:"Clear performance entries"},"Clear")),a.length>0?r("div",{style:Sr},a.map(s=>r("div",{key:s.metric,style:{...vr,borderLeft:`3px solid ${Pe[s.entry.rating]}`},title:fr[s.metric]},r("span",{style:{...wr,color:Pe[s.entry.rating]}},`${s.displayValue}${s.unit}`),r("span",{style:kr},s.metric)))):null,e.length>0?r("div",{style:Cr}):null,e.length>0?r("div",{style:$r},"Event Log"):null,e.length===0?r("div",{style:Dr},"Waiting for Web Vitals data..."):r("div",{style:Er},[...e].reverse().map(s=>{const l=jt[s.metric],c=s.metric==="CLS"?s.value.toFixed(3):`${Math.round(s.value)}`;return r("div",{key:s.id,style:{...Br,backgroundColor:pr[s.rating]}},r("span",{style:{...Tr,backgroundColor:Pe[s.rating]}},Hr(s.rating)),r("span",{style:Rr},s.metric),r("span",{style:Mr},`${c}${l}`),r("span",{style:zr},hr(s.timestamp)))})))}const Ie="devtools-debug-snapshots",Pr="devtools-screenshot-folder",Ut="/Users/jb/Downloads/Misc/Temp Assets/DevTools Debug",Ir=5;function Ar(){try{return localStorage.getItem(Pr)??Ut}catch{return Ut}}function Or(){try{const e=localStorage.getItem(Ie);return e?JSON.parse(e):[]}catch{return[]}}function qt(e){try{localStorage.setItem(Ie,JSON.stringify(e))}catch{}}let Nr=1;function le(e){return String(e).padStart(2,"0")}function Xt(e){const t=new Date(e);return`${le(t.getHours())}:${le(t.getMinutes())}:${le(t.getSeconds())}`}function Fr(){const e=[];try{const t=Object.keys(localStorage).filter(n=>n!==Ie);if(t.length){const n=t.slice(0,30).map(o=>{const a=localStorage.getItem(o)??"";return`  ${o}: ${a.length>120?a.slice(0,120)+"…":a}`});e.push(`localStorage (${t.length} keys):
${n.join(`
`)}`)}}catch{}try{const t=Object.keys(sessionStorage);if(t.length){const n=t.slice(0,30).map(o=>{const a=sessionStorage.getItem(o)??"";return`  ${o}: ${a.length>120?a.slice(0,120)+"…":a}`});e.push(`sessionStorage (${t.length} keys):
${n.join(`
`)}`)}}catch{}return e.length?e.join(`

`):"(empty)"}function Wr(){try{const t=performance.getEntriesByType("navigation")[0];return t?[`DNS: ${Math.round(t.domainLookupEnd-t.domainLookupStart)}ms`,`Connect: ${Math.round(t.connectEnd-t.connectStart)}ms`,`TTFB: ${Math.round(t.responseStart-t.requestStart)}ms`,`DOM Ready: ${Math.round(t.domContentLoadedEventEnd)}ms`,`Page Load: ${Math.round(t.loadEventEnd)}ms`].join(" | "):"(not available)"}catch{return"(not available)"}}function jr(){try{const e=document.cookie.split(";").map(t=>t.trim().split("=")[0]).filter(Boolean);return e.length?e.join(", "):"(none)"}catch{return"(unavailable)"}}function Ur(e,t,n,o){const s=new Date().toISOString().replace("T"," ").slice(0,19),l=Z(),c=te(),g=re(),d=t?l.filter(x=>x.level==="error"||x.level==="warn"):[...l],f=t?c.filter(x=>x.status===0||x.status>=400):[...c],i=[];if(i.push(`# Debug Snapshot — ${s}`),i.push(""),i.push(`**URL:** ${window.location.href}`),document.title&&i.push(`**Page:** ${document.title}`),i.push(`**Viewport:** ${window.innerWidth} x ${window.innerHeight}`),i.push(`**User-Agent:** ${navigator.userAgent}`),i.push(`**Cookies:** ${jr()}`),i.push(""),o.trim()&&(i.push("## Notes"),i.push(o.trim()),i.push("")),e.length){i.push(`## Screenshots (${e.length} downloaded)`);const x=n.replace(/\/+$/,"");i.push(e.map(k=>`${x}/${k.name}`).join(", ")),i.push("")}const p=t?`${d.length} warnings/errors of ${l.length} total`:`${d.length} entries`;if(i.push(`## Console — ${p}`),!d.length)i.push("(none)");else for(const x of d.slice(-60))i.push(`[${Xt(x.timestamp)}] ${x.level.toUpperCase().padEnd(5)} ${x.args.join(" ")}`);i.push("");const h=t?`${f.length} errors of ${c.length} total`:`${f.length} requests`;if(i.push(`## Network — ${h}`),!f.length)i.push("(none)");else for(const x of f.slice(-40)){const k=x.status===0?"ERR":String(x.status);i.push(`${x.method.padEnd(6)} ${x.url} — ${k} (${x.duration}ms)`)}if(i.push(""),i.push(`## JavaScript Errors — ${g.length}`),!g.length)i.push("(none)");else for(const x of g){const k=x.type==="unhandledrejection"?"UnhandledRejection":"Error";if(i.push(`[${Xt(x.timestamp)}] ${k}: ${x.message}`),x.source&&i.push(`  at ${x.source}:${x.line}:${x.col}`),x.stack){const b=x.stack.split(`
`).slice(1,7).map(_=>_.trim()).filter(Boolean);for(const _ of b)i.push(`  ${_}`)}}return i.push(""),i.push("## Storage"),i.push(Fr()),i.push(""),i.push("## Page Timing"),i.push(Wr()),i.join(`
`)}function qr(e){for(const t of e){const n=document.createElement("a");n.href=t.url,n.download=t.name,document.body.appendChild(n),n.click(),document.body.removeChild(n)}}async function Xr(){const e=await navigator.mediaDevices.getDisplayMedia({video:{displaySurface:"browser"},preferCurrentTab:!0}),t=document.createElement("video");t.srcObject=e,t.muted=!0,await new Promise(d=>{t.onloadedmetadata=()=>{t.play().then(d).catch(d)}}),await new Promise(d=>setTimeout(d,120));const n=1920,o=t.videoWidth||window.innerWidth,a=t.videoHeight||window.innerHeight,s=o>n?n/o:1,l=document.createElement("canvas");l.width=Math.round(o*s),l.height=Math.round(a*s);const c=l.getContext("2d");let g=null;return c&&(c.drawImage(t,0,0,l.width,l.height),g=await new Promise(d=>l.toBlob(d,"image/webp",.82))),e.getTracks().forEach(d=>d.stop()),t.srcObject=null,g}const Yr={display:"flex",flexDirection:"column",height:"100%",width:"100%",overflow:"hidden",boxSizing:"border-box"},Vr={display:"flex",flexShrink:"0",borderBottom:`1px solid ${u.panelBorder}`};function Yt(e){return{flex:"1",padding:"7px 4px",border:"none",borderBottom:e?`2px solid ${u.fabBg}`:"2px solid transparent",backgroundColor:"transparent",color:e?u.textBright:u.textMuted,fontSize:"11px",fontWeight:"600",cursor:"pointer",transition:"color 0.1s",boxSizing:"border-box"}}const Vt={flex:"1",overflowY:"auto",overflowX:"hidden",padding:"8px",display:"flex",flexDirection:"column",gap:"8px",boxSizing:"border-box"},Ae={fontSize:"10px",fontWeight:"600",color:u.textMuted,textTransform:"uppercase",letterSpacing:"0.4px",marginBottom:"4px",display:"block"},Gr={display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"4px"};function Oe(e,t){return{padding:"6px",borderRadius:"4px",backgroundColor:e>0?`${t}22`:u.toolBtnBg,border:`1px solid ${e>0?t:u.panelBorder}`,textAlign:"center"}}const Ne={fontSize:"16px",fontWeight:"700",color:u.textBright,display:"block"},Fe={fontSize:"9px",color:u.textMuted,textTransform:"uppercase",letterSpacing:"0.3px"},Jr={border:`1px dashed ${u.panelBorder}`,borderRadius:"6px",padding:"10px",minHeight:"64px",display:"flex",flexDirection:"column",gap:"6px"},Kr={display:"flex",flexWrap:"wrap",gap:"4px"},Zr={position:"relative",width:"56px",height:"40px",borderRadius:"3px",overflow:"hidden",flexShrink:"0",border:`1px solid ${u.panelBorder}`,cursor:"default"},Qr={width:"100%",height:"100%",objectFit:"cover"},es={position:"absolute",top:"1px",right:"1px",width:"14px",height:"14px",borderRadius:"2px",border:"none",backgroundColor:"rgba(0,0,0,0.7)",color:"#fff",fontSize:"9px",lineHeight:"1",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",padding:"0"},ts={fontSize:"11px",color:u.textMuted,textAlign:"center"},Gt={display:"flex",gap:"4px"};function me(e="muted"){const t=e==="primary"?u.fabBg:e==="danger"?"#7f1d1d":u.toolBtnBg,n=e==="primary"?"#fff":e==="danger"?"#fca5a5":u.textMuted;return{flex:"1",padding:"5px 8px",borderRadius:"4px",border:"none",backgroundColor:t,color:n,fontSize:"11px",fontWeight:"500",cursor:"pointer",whiteSpace:"nowrap"}}const ns=e=>({width:"100%",padding:"9px 12px",borderRadius:"6px",border:"none",backgroundColor:e?"#1e293b":u.fabBg,color:e?u.textMuted:"#fff",fontSize:"12px",fontWeight:"600",cursor:e?"not-allowed":"pointer"}),os=e=>({padding:"3px 8px",borderRadius:"4px",border:`1px solid ${e?u.fabBg:u.panelBorder}`,backgroundColor:e?`${u.fabBg}33`:"transparent",color:e?"#93c5fd":u.textMuted,fontSize:"10px",cursor:"pointer",fontWeight:"500"}),rs={borderRadius:"6px",border:`1px solid ${u.panelBorder}`,backgroundColor:u.toolBtnBg,padding:"8px",display:"flex",flexDirection:"column",gap:"4px"},ss={fontSize:"10px",color:u.text,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},is={fontSize:"10px",color:u.textMuted},ls={display:"flex",alignItems:"center",justifyContent:"center",height:"100%",color:u.textMuted,fontSize:"12px",padding:"20px",textAlign:"center"};function as(){const[e,t]=y("capture"),[n,o]=y([]),[a,s]=y(Or),[l,c]=y(!1),[g,d]=y(null),[f,i]=y(!0),[p,h]=y(Ar),[x,k]=y(!1),[b,_]=y("");W(()=>()=>{for(const m of n)URL.revokeObjectURL(m.url)},[]),W(()=>{if(e!=="capture")return;function m(T){const I=T.clipboardData?.items;if(I){for(const A of Array.from(I))if(A.type.startsWith("image/")){const ye=A.getAsFile();ye&&v(ye)}}}return window.addEventListener("paste",m),()=>window.removeEventListener("paste",m)},[e]);function v(m){const T=Nr++,I=URL.createObjectURL(m),A=m.type==="image/webp"?"webp":m.type==="image/jpeg"?"jpg":"png";o(ye=>[...ye,{id:T,url:I,blob:m,name:`screenshot-${T}.${A}`}])}const $=w(async()=>{c(!0);try{const m=await Xr();m&&v(m)}catch{}c(!1)},[]),C=w(m=>{o(T=>{const I=T.find(A=>A.id===m);return I&&URL.revokeObjectURL(I.url),T.filter(A=>A.id!==m)})},[]),D=w(()=>{o(m=>{for(const T of m)URL.revokeObjectURL(T.url);return[]})},[]),z=w(m=>{d(m),setTimeout(()=>d(null),2e3)},[]),j=w(async()=>{const m=Ur(n,f,p,b);n.length>0&&qr(n);const T={id:String(Date.now()),timestamp:Date.now(),pageUrl:window.location.href,report:m};s(I=>{const A=[T,...I].slice(0,Ir);return qt(A),A}),await navigator.clipboard.writeText(m),z(T.id)},[n,f,p,b,z]),P=w(async m=>{await navigator.clipboard.writeText(m.report),z(m.id)},[z]),L=w(m=>{s(T=>{const I=T.filter(A=>A.id!==m);return qt(I),I})},[]),H=Z(),S=te(),B=re(),O=H.filter(m=>m.level==="error"||m.level==="warn").length,N=S.filter(m=>m.status===0||m.status>=400).length;return r("div",{style:Yr},r("div",{style:Vr},r("button",{style:Yt(e==="capture"),onClick:()=>t("capture")},"Capture"),r("button",{style:Yt(e==="history"),onClick:()=>t("history")},`History (${a.length})`)),e==="capture"?r("div",{style:Vt},r("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},r("span",{style:Ae},"Report data"),r("button",{style:os(f),onClick:()=>i(m=>!m)},f?"Errors only":"All entries")),r("div",{style:Gr},r("div",{style:Oe(O,"#eab308")},r("span",{style:Ne},String(O)),r("span",{style:Fe},"Console")),r("div",{style:Oe(N,"#ef4444")},r("span",{style:Ne},String(N)),r("span",{style:Fe},"Net Errors")),r("div",{style:Oe(B.length,"#ef4444")},r("span",{style:Ne},String(B.length)),r("span",{style:Fe},"JS Errors"))),r("div",null,r("span",{style:Ae},`Screenshots (${n.length})`),r("div",{style:Jr},n.length===0?r("div",{style:ts},"Cmd+V to paste a screenshot",r("br",null),"or click Capture below"):r("div",{style:Kr},n.map(m=>r("div",{key:m.id,style:Zr,title:m.name},r("img",{src:m.url,style:Qr,alt:m.name}),r("button",{style:es,onClick:()=>C(m.id),title:"Remove"},"×")))),r("div",{style:Gt},r("button",{style:me("muted"),onClick:$,disabled:l,title:"Capture current screen (opens share dialog)"},l?"Capturing...":"Capture Screen"),n.length>0?r("button",{style:me("danger"),onClick:D,title:"Delete all screenshots"},"Delete All"):null))),r("div",null,r("span",{style:Ae},"Notes (optional)"),r("textarea",{value:b,onInput:m=>_(m.target.value),placeholder:"Add your own comments or context…",rows:3,style:{width:"100%",background:u.toolBtnBg,border:`1px solid ${u.panelBorder}`,borderRadius:"4px",color:u.text,fontSize:"11px",padding:"5px 6px",resize:"vertical",fontFamily:"system-ui, -apple-system, sans-serif",boxSizing:"border-box"}})),r("button",{style:ns(!1),onClick:j,title:"Copy debug report to clipboard. Screenshots (if any) download as files."},g?"Copied!":"Copy Report & Download Screenshots"),r("div",{style:{fontSize:"10px",color:u.textMuted}},"Screenshots save to your browser’s Downloads folder automatically.")):r("div",{style:{...Vt,gap:"6px"}},a.length===0?r("div",{style:ls},"No snapshots yet. Copy a report from the Capture tab to save it here."):a.map(m=>{const T=new Date(m.timestamp),I=`${T.toLocaleDateString()} ${le(T.getHours())}:${le(T.getMinutes())}`,A=g===m.id;return r("div",{key:m.id,style:rs},r("div",{style:is},I),r("div",{style:ss,title:m.pageUrl},m.pageUrl),r("div",{style:Gt},r("button",{style:me(A?"primary":"muted"),onClick:()=>P(m)},A?"Copied!":"Copy Report"),r("button",{style:me("danger"),onClick:()=>L(m.id)},"Delete")))})))}const Jt=[{id:"debug",label:"Debug Snapshot",icon:"⊚"},{id:"console",label:"Console Viewer",icon:">"},{id:"network",label:"Network Viewer",icon:"⇅"},{id:"errors",label:"Error Log",icon:"⚠"},{id:"bugs",label:"Bug Reporter",icon:"🐛"},{id:"perf",label:"Performance",icon:"⚡"},{id:"ai",label:"AI Assistant",icon:"✨"}];function cs({projectId:e,isOpen:t,onClose:n,apiClient:o,apiBase:a,pinHash:s}){const[l,c]=y(null),[g,d]=y(!1),[f,i]=y(null),[p,h]=y(""),[x,k]=y(""),[b,_]=y(()=>({x:Math.max(0,window.innerWidth-Re-4),y:0})),[v,$]=y(!1),C=q(null),D=w(S=>{S.target.closest("button")||(S.currentTarget.setPointerCapture(S.pointerId),C.current={startX:S.clientX,startY:S.clientY,originX:b.x,originY:b.y},$(!0))},[b.x,b.y]),z=w(S=>{if(!C.current)return;const{startX:B,startY:O,originX:N,originY:m}=C.current,T=window.innerWidth-Re,I=window.innerHeight-48;_({x:Math.max(0,Math.min(T,N+(S.clientX-B))),y:Math.max(0,Math.min(I,m+(S.clientY-O)))})},[]),j=w(()=>{C.current=null,$(!1)},[]),P=w(S=>{c(B=>(B==="bugs"&&S!=="bugs"&&(h(""),k("")),B===S?null:S))},[]),L=w(S=>{h(S.message),k(S.stack),c("bugs")},[]),H=l?Jt.find(S=>S.id===l):null;return r("div",{style:{...hn,left:`${b.x}px`,top:`${b.y}px`,height:"min(85vh, 700px)",opacity:t?"1":"0",transition:"opacity 0.2s ease",pointerEvents:t?"auto":"none"},"aria-hidden":!t},r("div",{style:{...xn,cursor:v?"grabbing":"grab",userSelect:"none"},onPointerDown:D,onPointerMove:z,onPointerUp:j},r("span",{style:_n,title:e},e),r("button",{style:{...mn,backgroundColor:g?u.closeBtnHover:"transparent",color:g?"#fff":u.textMuted},onClick:n,onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),"aria-label":"Close panel",title:"Close"},"✕")),r("div",{style:yn},Jt.map(S=>{const B=l===S.id,O=f===S.id;let N=u.toolBtnBg;return B?N=u.toolBtnBgActive:O&&(N=u.toolBtnBgHover),r("button",{key:S.id,style:{...bn,backgroundColor:N,color:B?"#fff":u.text},onClick:()=>P(S.id),onMouseEnter:()=>i(S.id),onMouseLeave:()=>i(null)},r("span",{style:Sn},S.icon),r("span",null,S.label))})),H?r("div",{style:{...vn,borderTop:`1px solid ${u.panelBorder}`,...l==="debug"||l==="console"||l==="network"||l==="errors"||l==="bugs"||l==="perf"||l==="ai"?{alignItems:"stretch",justifyContent:"stretch",padding:"0"}:{}}},l==="debug"?r(as,null):l==="console"?r(Un,null):l==="network"?r(mo,null):l==="errors"?r(jo,{onReportBug:L}):l==="bugs"?r(At,{apiClient:o,projectId:e,prefillTitle:p||void 0,prefillStack:x||void 0}):l==="perf"?r(Lr,null):l==="ai"?r(sr,{apiBase:a,pinHash:s}):r("span",null,`${H.label} -- coming soon`)):null)}const Kt={isDragging:!1,startX:0,startY:0,offsetX:0,offsetY:0,moved:!1},ds=r("svg",{width:"22",height:"22",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},r("path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"}));function us({projectId:e,pinHash:t,apiBase:n,apiClient:o}){const[a,s]=y(!1),[l,c]=y(!1),[g,d]=y({x:0,y:0}),[f,i]=y(!1),p=q(Kt),h=q(null),x=w($=>{$.currentTarget.setPointerCapture($.pointerId),p.current={isDragging:!0,startX:$.clientX,startY:$.clientY,offsetX:g.x,offsetY:g.y,moved:!1},i(!0)},[g.x,g.y]),k=w($=>{const C=p.current;if(!C.isDragging)return;const D=$.clientX-C.startX,z=$.clientY-C.startY;Math.sqrt(D*D+z*z)>fn&&(p.current={...C,moved:!0}),d({x:C.offsetX+D,y:C.offsetY+z})},[]),b=w(()=>{const C=p.current.moved;p.current={...Kt},i(!1),C||s(D=>!D)},[]),_=w(()=>{s(!1)},[]),v={...gn,bottom:`${20-g.y}px`,right:`${20-g.x}px`,backgroundColor:l?u.fabBgHover:u.fabBg,boxShadow:l?`0 6px 16px ${u.shadow}`:`0 4px 12px ${u.shadow}`,cursor:f?"grabbing":"grab"};return r("div",null,r("button",{ref:h,style:v,title:`DevTools (${e})`,"aria-label":"Toggle DevTools panel",onPointerDown:x,onPointerMove:k,onPointerUp:b,onMouseEnter:()=>c(!0),onMouseLeave:()=>c(!1)},ds),r(cs,{projectId:e,isOpen:a,onClose:_,apiClient:o,apiBase:n,pinHash:t}))}function Zt(e,t){async function n(o,a={}){return(await fetch(`${e}${o}`,{...a,headers:{"Content-Type":"application/json","X-DevTools-Pin":t,...a.headers}})).json()}return{createBug:o=>n("/api/bugs",{method:"POST",body:JSON.stringify(o)}),createDevLog:o=>n("/api/devlog",{method:"POST",body:JSON.stringify(o)}),sendEvents:o=>n("/api/widget/event",{method:"POST",body:JSON.stringify({events:o})})}}const ps=console.warn.bind(console),fs=1e4,gs=50,hs=200,xs=new Set(["log","info","warn","error","debug"]);function _s(e,t,n){let o=[];function a(f){o.length>=hs||(o.push(f),o.length>=gs&&s())}function s(){if(o.length===0)return;const f=[...o];o=[],t.sendEvents(f).catch(i=>{ps("[DevTools] Failed to send events:",i)})}function l(){if(o.length===0)return;const f=[...o];o=[];const i=JSON.stringify({events:f}),p=`${n}/api/widget/event`;try{const h=new Blob([i],{type:"application/json"});navigator.sendBeacon(p,h)}catch{}}let c=0;zt(()=>{const i=re().filter(p=>p.id>c);if(i.length>0){c=i[i.length-1].id;for(const p of i)a({type:"error",title:p.message,content:p.stack,metadata:{errorType:p.type,source:p.source,line:p.line,col:p.col},projectId:e})}}),Wt(f=>{a({type:"perf",title:`${f.metric}: ${f.value}`,content:`Rating: ${f.rating}`,metadata:{metric:f.metric,value:f.value,rating:f.rating},projectId:e})});let g=0;_t(()=>{const i=Z().filter(p=>p.id>g);if(i.length>0){g=i[i.length-1].id;for(const p of i){if(!xs.has(p.level))continue;const h=p.args.join(" ");h.includes("/api/widget/")||h.includes("/api/ai/analyze")||a({type:"console",title:h.slice(0,500),content:p.args.join(`
`).slice(0,2e3),metadata:{level:p.level,argCount:p.args.length},projectId:e})}}});let d=0;vt(()=>{const i=te().filter(p=>p.id>d);if(i.length>0){d=i[i.length-1].id;for(const p of i)p.url.includes("/api/widget/")||p.url.includes("/api/bugs")||p.url.includes("/api/ai/analyze")||a({type:"network",title:`${p.method} ${p.url}`.slice(0,500),content:`${p.status} ${p.statusText} (${p.duration}ms)`,metadata:{method:p.method,url:p.url,status:p.status,statusText:p.statusText,duration:p.duration,requestSize:p.requestSize,responseSize:p.responseSize},projectId:e})}}),setInterval(s,fs),window.addEventListener("beforeunload",l)}function ms(e,t,n){Tn(),Gn(),So(),ur();const o=Zt(n,t);_s(e,o,n)}const ys=1e4,bs={position:"fixed",bottom:"80px",right:"20px",width:"340px",maxHeight:"280px",backgroundColor:"#1a0000",border:"1px solid #dc2626",borderRadius:"8px",boxShadow:"0 8px 24px rgba(220, 38, 38, 0.3)",zIndex:"999997",fontFamily:"system-ui, -apple-system, sans-serif",color:u.text,overflow:"hidden",display:"flex",flexDirection:"column"},Ss={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:"rgba(220, 38, 38, 0.2)",borderBottom:"1px solid #dc2626",flexShrink:"0"},vs={fontSize:"12px",fontWeight:"600",color:"#fca5a5"},ws={display:"flex",gap:"6px"},Qt={padding:"3px 8px",borderRadius:"4px",border:"none",cursor:"pointer",fontSize:"11px",fontWeight:"500"},ks={...Qt,backgroundColor:"#dc2626",color:"#fff"},Cs={...Qt,backgroundColor:"rgba(255, 255, 255, 0.1)",color:u.textMuted},$s={padding:"8px 12px",overflowY:"auto",flex:"1"},Es={fontSize:"12px",fontWeight:"500",color:"#fca5a5",marginBottom:"6px",wordBreak:"break-word"},Bs={fontSize:"10px",fontFamily:"monospace",lineHeight:"1.6",color:u.textMuted},en={padding:"1px 0",wordBreak:"break-all"},Ts={...en,opacity:"0.5"};function Rs(e){return e?e.split(`
`).map(t=>t.trim()).filter(t=>t.length>0):[]}function Ms(e){return e.includes("node_modules")}function zs({onReportBug:e}){const[t,n]=y(null),o=q(null),a=w(()=>{n(null),o.current&&(clearTimeout(o.current),o.current=null)},[]),s=w(()=>{o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{n(null),o.current=null},ys)},[]);W(()=>(Rt(f=>{n(f),s()}),()=>{Rt(null),o.current&&clearTimeout(o.current)}),[s]);const l=w(()=>{o.current&&(clearTimeout(o.current),o.current=null)},[]),c=w(()=>{t&&s()},[t,s]),g=w(()=>{t&&(e(t),a())},[t,e,a]);if(!t)return null;const d=Rs(t.stack);return r("div",{style:bs,onMouseEnter:l,onMouseLeave:c},r("div",{style:Ss},r("span",{style:vs},t.type==="error"?"Uncaught Error":"Unhandled Rejection"),r("div",{style:ws},r("button",{style:ks,onClick:g},"Report Bug"),r("button",{style:Cs,onClick:a},"Dismiss"))),r("div",{style:$s},r("div",{style:Es},t.message),d.length>0?r("div",{style:Bs},d.slice(0,8).map((f,i)=>r("div",{key:i,style:Ms(f)?Ts:en},f))):null))}const Ds={position:"fixed",padding:"6px 12px",borderRadius:"6px",border:"none",backgroundColor:u.fabBg,color:"#fff",cursor:"pointer",fontSize:"12px",fontWeight:"600",zIndex:999999,boxShadow:"0 2px 8px rgba(0, 0, 0, 0.3)",display:"flex",alignItems:"center",gap:"4px",fontFamily:"system-ui, -apple-system, sans-serif"},Hs={position:"fixed",width:"360px",maxHeight:"320px",backgroundColor:u.panelBg,border:`1px solid ${u.panelBorder}`,borderRadius:"8px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",zIndex:999999,display:"flex",flexDirection:"column",fontFamily:"system-ui, -apple-system, sans-serif",overflow:"hidden"},Ls={display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 12px",backgroundColor:u.panelHeaderBg,borderBottom:`1px solid ${u.panelBorder}`,flexShrink:0},Ps={fontSize:"12px",fontWeight:"600",color:u.textBright},Is={width:"24px",height:"24px",borderRadius:"4px",border:"none",backgroundColor:"transparent",color:u.textMuted,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"14px",lineHeight:"1"},As={padding:"12px",overflowY:"auto",flex:1,fontSize:"13px",lineHeight:"1.5",color:u.text,whiteSpace:"pre-wrap",wordBreak:"break-word"},Os={padding:"16px 12px",fontSize:"12px",color:u.textMuted,textAlign:"center"},Ns={padding:"12px",fontSize:"12px",color:"#ef4444",backgroundColor:"rgba(239, 68, 68, 0.1)",borderRadius:"4px",margin:"8px 12px"};function tn(e,t,n,o){const a=Math.min(Math.max(e,8),window.innerWidth-n-8),s=Math.min(Math.max(t,8),window.innerHeight-o-8);return{x:a,y:s}}function Fs({apiBase:e,pinHash:t}){const[n,o]=y(""),[a,s]=y(null),[l,c]=y(null),[g,d]=y("idle"),[f,i]=y(""),[p,h]=y(""),[x,k]=y(!1),[b,_]=y(!1),v=q(null),$=q(null),C=w(()=>{s(null),c(null),o(""),d("idle"),i(""),h(""),v.current&&(v.current.abort(),v.current=null)},[]);W(()=>{function P(L){if(L.target.closest?.("[data-quickai]"))return;const B=window.getSelection()?.toString().trim()??"";if(B.length>10){o(B);const O=tn(L.clientX,L.clientY-40,90,30);s(O)}else l||(s(null),o(""))}return document.addEventListener("mouseup",P),()=>document.removeEventListener("mouseup",P)},[l]),W(()=>{if(!l)return;function P(H){H.target.closest?.("[data-quickai]")||C()}const L=setTimeout(()=>{document.addEventListener("mousedown",P)},100);return()=>{clearTimeout(L),document.removeEventListener("mousedown",P)}},[l,C]);const D=w(async()=>{if(!n)return;const P=a?tn(a.x,a.y+36,360,320):{x:100,y:100};c(P),s(null),d("loading"),i(""),h(""),v.current&&v.current.abort();const L=new AbortController;v.current=L;try{const H=await fetch(`${e}/api/ai/analyze`,{method:"POST",headers:{"Content-Type":"application/json","X-DevTools-Pin":t},body:JSON.stringify({text:n,context:window.location.href}),signal:L.signal});if(!H.ok)throw new Error(`Analysis failed (${H.status})`);const S=H.body?.getReader();if(!S)throw new Error("No response stream");d("streaming");const B=new TextDecoder;for(;;){const{done:O,value:N}=await S.read();if(O)break;const m=B.decode(N,{stream:!0});m&&i(T=>T+m)}d("done")}catch(H){if(H.name==="AbortError")return;d("error");const S=H instanceof Error?H.message:"Analysis failed";h(S)}},[n,a,e,t]),z=a?r("button",{"data-quickai":"btn",style:{...Ds,left:`${a.x}px`,top:`${a.y}px`,backgroundColor:x?u.fabBgHover:u.fabBg},onClick:D,onMouseEnter:()=>k(!0),onMouseLeave:()=>k(!1)},"✨ Analyze"):null,j=l?r("div",{ref:$,"data-quickai":"popup",style:{...Hs,left:`${l.x}px`,top:`${l.y}px`}},r("div",{style:Ls},r("span",{style:Ps},"AI Analysis"),r("button",{style:{...Is,backgroundColor:b?u.closeBtnHover:"transparent",color:b?"#fff":u.textMuted},onClick:C,onMouseEnter:()=>_(!0),onMouseLeave:()=>_(!1),"aria-label":"Close"},"✕")),g==="loading"?r("div",{style:Os},"Analyzing..."):g==="error"?r("div",{style:Ns},p):r("div",{style:As},f||"Waiting...")):null;return r("div",{"data-quickai":"root"},z,j)}const We=document.currentScript,Ws=[":host { all: initial; }","#devtools-root { font-family: system-ui, sans-serif; }"].join(`
`);function js({projectId:e,pinHash:t,apiBase:n,apiClient:o}){const[a,s]=y(null),l=w(g=>{s(g)},[]),c=w(()=>{s(null)},[]);return r("div",null,r(us,{projectId:e,pinHash:t,apiBase:n,apiClient:o}),r(zs,{onReportBug:l}),r(Fs,{apiBase:n,pinHash:t}),a?r("div",{style:{position:"fixed",bottom:"80px",right:"20px",width:"340px",maxHeight:"400px",backgroundColor:"#0f172a",border:"1px solid #1e293b",borderRadius:"8px",boxShadow:"0 8px 24px rgba(0, 0, 0, 0.4)",zIndex:"999997",overflow:"auto"}},r(At,{apiClient:o,projectId:e,prefillTitle:a.message,prefillStack:a.stack,onClose:c})):null)}function nn(){const e=We?.getAttribute("data-project")||"default",t=We?.getAttribute("data-pin")||"",n=We?.src.replace("/widget.js","")||"",o=Zt(n,t),a=document.createElement("div");a.id="devtools-widget",document.body.appendChild(a);const s=a.attachShadow({mode:"open"}),l=document.createElement("style");l.textContent=Ws,s.appendChild(l);const c=document.createElement("div");c.id="devtools-root",s.appendChild(c),cn(r(js,{projectId:e,pinHash:t,apiBase:n,apiClient:o}),c),ms(e,t,n)}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",nn):nn()})();
